<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"zhaoquaner.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="赵圈儿的博客">
<meta property="og:url" content="https://zhaoquaner.github.io/page/15/index.html">
<meta property="og:site_name" content="赵圈儿的博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ZhaoXin">
<meta property="article:tag" content="博客">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://zhaoquaner.github.io/page/15/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/15/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>赵圈儿的博客</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">赵圈儿的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">23</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">18</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">169</span></a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ZhaoXin"
      src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
  <p class="site-author-name" itemprop="name">ZhaoXin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">169</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/zhaoquaner" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zhaoquaner" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zx1522202417@163.com" title="E-Mail → mailto:zx1522202417@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/Java/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E5%88%9B%E5%BB%BA%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/Java/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E5%88%9B%E5%BB%BA%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/" class="post-title-link" itemprop="url">创建多线程的三种方式</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 10:55:39 / 修改时间：16:52:49" itemprop="dateCreated datePublished" datetime="2022-05-11T10:55:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/java/" itemprop="url" rel="index"><span itemprop="name">Java基础</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="继承thread类">继承Thread类</h2>
<p><strong>通过继承Thread类来创建并启动多线程的步骤为：</strong></p>
<ol type="1">
<li>定义Thread类的子类，并继承重写该类的run()方法，该run()方法就代表该线程要完成的任务。</li>
<li>创建Thread子类的实例</li>
<li>调用该实例对象的start()方法启动该线程</li>
</ol>
<h2 id="实现runnable接口创建线程类">实现Runnable接口创建线程类</h2>
<p><strong>步骤如下：</strong></p>
<ol type="1">
<li>定义Runnable接口的实现类，重写该接口的run()方法</li>
<li>创建Runnable接口的实例，并用该实例对象作为Thread的target来创建Thread对象，该Thread才是真正的线程对象</li>
<li>调用线程对象的start方法启动该线程</li>
</ol>
<p>例子(SecondThread实现了Runnable接口)：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">var</span> <span class="variable">st</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecondThread</span>();</span><br><span class="line"><span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(st);</span><br></pre></td></tr></table></figure>
<h2 id="使用callable和future创建线程">使用Callable和Future创建线程</h2>
<p>Callable接口提供了call()方法来作为线程执行体，但是call方法比run方法功能更强大</p>
<ul>
<li>call方法可以有返回值</li>
<li>call方法可以声明抛出异常</li>
</ul>
<p>Java提供了Future接口来代表Callable接口call方法的返回值，并且为Future提供了一个FutureTask实现类，该实现类实现了Future接口，并且实现了Runnable接口，可以作为Thread类的target。</p>
<p>在Future接口定义了几个公共方法控制与它关联的Callable任务</p>
<hr />
<p><strong>boolean cancel(boolean mayInterruptRunning)</strong></p>
<p>功能：试图取消该Future关联的Callable任务</p>
<p>参数：</p>
<ul>
<li>mayInterruptRunning</li>
</ul>
<p>返回值：一个布尔值</p>
<hr />
<p><strong>V get()</strong></p>
<p>功能：返回Callable任务中的返回值，调用该任务，将导致程序阻塞，必须等到子线程结束才会得到返回值</p>
<p>参数：无</p>
<p>返回值：指定返回值</p>
<hr />
<p><strong>V get(long timeout, TimeUnit unit)</strong></p>
<p>功能：返回Callable任务里call任务的返回值，该方法让程序最多阻塞timeout和unit指定的时间，如果经过指定时间仍然没有返回值，将抛出TimeoutException异常</p>
<hr />
<p><strong>boolean isCanceled()</strong></p>
<p>功能：如果该Callable任务在正常完成前被取消，则返回true</p>
<hr />
<p><strong>boolean isDone()</strong></p>
<p>功能：如果该任务已经完成，返回true</p>
<hr />
<p>Callable接口有泛型限制，Callable接口里的泛型形参类型和call方法返回值相同，而且Callable接口为函数式接口，可以直接使用Lambda表达式创建Callable对象。</p>
<p>步骤为：</p>
<ol type="1">
<li>创建Callable接口的实现类，并实现call方法，创建实例对象</li>
<li>使用FutureTask来包装该实现类，该FutureTask对象封装了该Callable对象的call方法</li>
<li>使用FutureTask对象作为Thread对象的target创建线程对象，并启动线程</li>
<li>调用FutureTask对象的get方法来获得返回值</li>
</ol>
<h2 id="三种创建对象的方式对比">三种创建对象的方式对比</h2>
<p>实现Runnable接口和实现Callable接口的方式基本差不多，只是Callable接口里可以有返回值，可以声明抛出异常。因此可以将两种实现接口的方法归为一种方式，和继承Thread类的主要区别有：</p>
<ol type="1">
<li>线程类只是实现了接口，还可以继承其他类</li>
<li>在这种方式下，多个线程可以共享一个target对象，所以非常适合多个线程处理一份资源的情况，从而可以将CPU，代码和数据分开，形成清晰模型</li>
<li>劣势是，编程稍微复杂，如果需要访问当前线程，则必须使用Thread.currentThread方法</li>
</ol>
<p>采用继承Thread类的方法创建多线程优缺点为：</p>
<ol type="1">
<li>劣势是，因为线程类已经继承了Thread，不能再继承其他类</li>
<li>优势是，编程简单，如果要访问当前线程，直接使用this</li>
</ol>
<p>综上，一般推荐采用Runnable接口、Callable接口来创建多线程。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/Java/JDBC/%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E5%8F%8A%E6%89%B9%E9%87%8F%E6%9B%B4%E6%96%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/Java/JDBC/%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E5%8F%8A%E6%89%B9%E9%87%8F%E6%9B%B4%E6%96%B0/" class="post-title-link" itemprop="url">事务处理及批量更新</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 09:33:39 / 修改时间：16:54:20" itemprop="dateCreated datePublished" datetime="2022-05-11T09:33:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/java/" itemprop="url" rel="index"><span itemprop="name">Java基础</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="事务的概念和mysql事务支持">事务的概念和MySQL事务支持</h3>
<p>事务：是由一步或几步数据库操作序列组成的逻辑执行单元，<strong>这系列操作要么不执行，要么全部执行。</strong></p>
<p>事务具有四个特性：</p>
<ul>
<li>原子性：事务是应用中最小的执行单元。</li>
<li>一致性：事务执行的结果必须使数据库从一个一致性状态转换到另一个一致性状态。
当数据库只包含事务成功提交的结果时，数据库处于一致性状态。如果系统运行发生中断，某个事务尚未完成而被迫中断，而该事务对数据库做的修改已经被写入数据库，此时，数据库处于不正确的状态。
例如：A给B转账1000元，系统先在A的账户减去1000，再在B的账户加上1000，如果都执行成功，则数据库处于一致性状态，如果给A减了1000，但在给B加上1000时，出错了，没有执行成功，此时就没有处于一致性状态。</li>
<li>隔离性：各个事务的执行互不干扰</li>
<li>持续性：指事务一旦提交，对数据所做的任何改变都要记录到永久存储器中，通常就是保存到物理数据库</li>
</ul>
<p>数据库事务由以下语句构成：</p>
<ul>
<li>一组数据操作语句(DML)；</li>
<li>一条数据定义语句(DDL)；</li>
<li>一条数据控制语句(DCL)；</li>
</ul>
<h5 id="注意">注意</h5>
<p>DDL和DCL语句最多只能有一条，因为DDL和DCL语句都会导致事务立即提交。</p>
<p>当事务全部执行成功后，应该提交事务。事务提交有两种方式：</p>
<ul>
<li>显式提交：使用commit</li>
<li>自动提交：执行DCL或DDL语句，或者程序正常退出</li>
</ul>
<p>当事务包含的操作执行失败后，应该回滚(rollback)事务，使之前所做的修改全部失效。事务回滚有两种方式：</p>
<ul>
<li>显式回滚：使用rollback</li>
<li>自动回滚：系统错误或者强行退出</li>
</ul>
<p>MySQL默认打开自动提交，在默认情况，用户输入一条DML语句,这条语句将会立即保存到数据库。
使用<code>set autocommit = 0</code>
开启显式提交。<strong>但只对本次连接有效，对其他连接到数据库的连接无效。</strong></p>
<h5 id="注意-1">注意</h5>
<p>使用commit提交只对DML语句有效，当执行DDL和DCL时，不管是否为显式提交，都会立即提交。</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set autocommit = 0;</span><br><span class="line"> begin;</span><br><span class="line"> insert into choose Values(&#x27;Get&#x27;, 20, 11.1, &#x27;Out&#x27;, &#x27;HaHa&#x27;);</span><br><span class="line"> select * from choose;</span><br></pre></td></tr></table></figure>
<p>结果</p>
<figure>
<img
src="C:\Users\Bu&#39;l&#39;l&#39;shi&#39;t\AppData\Roaming\Typora\typora-user-images\image-20200412102618429.png"
alt="image-20200412102618429" />
<figcaption aria-hidden="true">image-20200412102618429</figcaption>
</figure>
<p>接着执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rollback;</span><br><span class="line">select * from choose;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure>
<img
src="C:\Users\Bu&#39;l&#39;l&#39;shi&#39;t\AppData\Roaming\Typora\typora-user-images\image-20200412102738691.png"
alt="image-20200412102738691" />
<figcaption aria-hidden="true">image-20200412102738691</figcaption>
</figure>
<h2 id="jdbc的事务支持">JDBC的事务支持</h2>
<p>JDBC连接事务支持由Conncetion提供，Connection默认打开自动提交。</p>
<p>调用setAutoCommit()方法关闭自动提交：</p>
<p><code>conn.setAutoCommit(false)</code></p>
<p>调用commit()方法提交事务：</p>
<p><code>conn.commit()</code></p>
<p>如果任何一条语句执行失败，用rollback回滚事务：</p>
<p><code>conn.rollback()</code></p>
<h5 id="提示">提示</h5>
<p>当Connection遇到未处理的SQLException异常时，系统会非正常退出，事务会自动回滚，但是如果程序捕获了该异常，需要在异常处理块中显式回滚事务。</p>
<p>Connection也提供了设置中间点的方法：Savepoint
setSavepoint()、Savepoint setSavepoint(String name)</p>
<p>通常没有必要给中间点设置名称，当回滚到指定中间点时，是根据中间点对象回滚的，使用rollback(Savepoint
savepoint)回滚到指定中间点。</p>
<h3 id="批量更新">批量更新</h3>
<p>使用批量更新时，多条SQL语句被作为一批操作同时收集，并同时提交。</p>
<h5 id="提示-1">提示</h5>
<p>批量更新要得到底层数据库支持，可以调用DatabaseMetaData的supportBatchUpdate()方法查看底层数据库是否支持批量更新</p>
<p>使用批量更新需要创建一个Statement对象，用该对象的addBatch()方法收集多条SQL语句，最后调用exexuteLargeBatch()或executeBatch()执行这些语句。</p>
<p>实例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Statement stmt = conn.createStatement();</span><br><span class="line">//收集多条SQL语句</span><br><span class="line">stmt.addBatch(sql1);</span><br><span class="line">stmt.addBatch(sql2);</span><br><span class="line">stmt.addBatch(sql3);</span><br><span class="line">...</span><br><span class="line">//同时执行多条语句</span><br><span class="line">stmt.executeLargeBatch();</span><br></pre></td></tr></table></figure>
<p>执行后返回一个long[]数组，每个long值表示每条语句影响的行数，若addBatch()添加了查询语句，程序会直接出现错误。</p>
<p>实例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import java.sql.*;</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.util.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class BatchTest</span><br><span class="line">&#123;</span><br><span class="line">	private String driver;</span><br><span class="line">	private String url;</span><br><span class="line">	private String user;</span><br><span class="line">	private String pass;</span><br><span class="line">	public void initParam(String paramFile) throws Exception</span><br><span class="line">	&#123;</span><br><span class="line">		// 使用Properties类来加载属性文件</span><br><span class="line">		var props = new Properties();</span><br><span class="line">		props.load(new FileInputStream(paramFile));</span><br><span class="line">		driver = props.getProperty(&quot;driver&quot;);</span><br><span class="line">		url = props.getProperty(&quot;url&quot;);</span><br><span class="line">		user = props.getProperty(&quot;user&quot;);</span><br><span class="line">		pass = props.getProperty(&quot;pass&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	public void insertBatch(String[] sqls) throws Exception</span><br><span class="line">	&#123;</span><br><span class="line">		// 加载驱动</span><br><span class="line">		Class.forName(driver);</span><br><span class="line">		try (</span><br><span class="line">			Connection conn = DriverManager.getConnection(url, user, pass))</span><br><span class="line">		&#123;</span><br><span class="line">			// 关闭自动提交，开启事务</span><br><span class="line">			conn.setAutoCommit(false);</span><br><span class="line">			// 保存当前的自动的提交模式</span><br><span class="line">			boolean autoCommit = conn.getAutoCommit();</span><br><span class="line">			// 关闭自动提交</span><br><span class="line">			conn.setAutoCommit(false);</span><br><span class="line">			try (</span><br><span class="line">				// 使用Connection来创建一个Statement对象</span><br><span class="line">				Statement stmt = conn.createStatement())</span><br><span class="line">			&#123;</span><br><span class="line">				// 循环多次执行SQL语句</span><br><span class="line">				for (var sql : sqls)</span><br><span class="line">				&#123;</span><br><span class="line">					stmt.addBatch(sql);</span><br><span class="line">				&#125;</span><br><span class="line">				// 同时提交所有的SQL语句</span><br><span class="line">				stmt.executeLargeBatch();</span><br><span class="line">				// 提交修改</span><br><span class="line">				conn.commit();</span><br><span class="line">				// 恢复原有的自动提交模式</span><br><span class="line">				conn.setAutoCommit(autoCommit);</span><br><span class="line">			&#125;</span><br><span class="line">			// 提交事务</span><br><span class="line">			conn.commit();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	public static void main(String[] args) throws Exception</span><br><span class="line">	&#123;</span><br><span class="line">		var tt = new TransactionTest();</span><br><span class="line">		tt.initParam(&quot;mysql.ini&quot;);</span><br><span class="line">		var sqls = new String[]&#123;</span><br><span class="line">			&quot;insert into student_table values(null, &#x27;aaa&#x27;, 1)&quot;,</span><br><span class="line">			&quot;insert into student_table values(null, &#x27;bbb&#x27;, 1)&quot;,</span><br><span class="line">			&quot;insert into student_table values(null, &#x27;ccc&#x27;, 1)&quot;,</span><br><span class="line">		&#125;;</span><br><span class="line">		tt.insertInTransaction(sqls);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/Java/JDBC/%E7%AE%A1%E7%90%86%E7%BB%93%E6%9E%9C%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/Java/JDBC/%E7%AE%A1%E7%90%86%E7%BB%93%E6%9E%9C%E9%9B%86/" class="post-title-link" itemprop="url">管理结果集</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 09:32:39 / 修改时间：16:54:18" itemprop="dateCreated datePublished" datetime="2022-05-11T09:32:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/java/" itemprop="url" rel="index"><span itemprop="name">Java基础</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="可滚动可更新可修改的结果集">可滚动、可更新(可修改)的结果集</h2>
<p>使用absolute()、previous()、afterLast()等方法自由移动记录指针的ResultSet被称为可滚动的结果集。
在Java 5.0以后，默认打开的ResultSet()就是可滚动的。</p>
<p>以默认方式打开的ResultSet是不可更新的，必须要传入额外参数。Connection在创建Statement或PreparedStatement时，
传入如下两个参数：</p>
<ol type="1">
<li><p>resultSetType：可取三个值</p>
<ul>
<li>ResultSet.TYPE_FORWARD_ONLY：控制记录指针只能向前移动。</li>
<li>ResultSet.TYPE_SCROLL_INSENSITINE：记录指针可以自由移动(可滚动结果集)，但底层数据改变不会影响ResultSet
的内容。</li>
<li>ResultSet.TYPE_SCROLL_SENSTTIVE：记录指针可以自由移动(可滚动结果集)，底层数据改变会影响ResultSet
的内容。</li>
</ul></li>
<li><p>resultSetConcurrency：控制ResultSet的并发类型，可接收两个值。</p>
<ul>
<li><p>ResultSet.CONCUR_READ_ONLY：指示ResultSet是只读的并发模式（默认）</p></li>
<li><p>ResultSet.CONCUR_UPDATABLE：指示ResultSet是可更新的并发模式</p>
<p>例子:</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResultSetTest</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">private</span> String driver;</span><br><span class="line">	<span class="keyword">private</span> String url;</span><br><span class="line">	<span class="keyword">private</span> String user;</span><br><span class="line">	<span class="keyword">private</span> String pass;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initParam</span><span class="params">(String paramFile)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 使用Properties类来加载属性文件</span></span><br><span class="line">		<span class="type">var</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">		props.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(paramFile));</span><br><span class="line">		driver = props.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">		url = props.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">		user = props.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">		pass = props.getProperty(<span class="string">&quot;pass&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">(String sql)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 加载驱动</span></span><br><span class="line">		Class.forName(driver);</span><br><span class="line">		<span class="keyword">try</span> (</span><br><span class="line">			<span class="comment">// 获取数据库连接</span></span><br><span class="line">			<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, pass);</span><br><span class="line">			<span class="comment">// 使用Connection来创建一个PreparedStatement对象</span></span><br><span class="line">			<span class="comment">// 传入控制结果集可滚动，可更新的参数。</span></span><br><span class="line">			<span class="type">PreparedStatement</span> <span class="variable">pstmt</span> <span class="operator">=</span> conn.prepareStatement(sql,</span><br><span class="line">				ResultSet.TYPE_SCROLL_INSENSITIVE,</span><br><span class="line">				ResultSet.CONCUR_UPDATABLE);</span><br><span class="line">			<span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> pstmt.executeQuery())</span><br><span class="line">		&#123;</span><br><span class="line">			rs.last();</span><br><span class="line">			<span class="type">int</span> <span class="variable">rowCount</span> <span class="operator">=</span> rs.getRow();</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">var</span> <span class="variable">i</span> <span class="operator">=</span> rowCount; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">			&#123;</span><br><span class="line">				rs.absolute(i);</span><br><span class="line">				System.out.println(rs.getString(<span class="number">1</span>) + <span class="string">&quot;\t&quot;</span></span><br><span class="line">					+ rs.getString(<span class="number">2</span>) + <span class="string">&quot;\t&quot;</span> + rs.getString(<span class="number">3</span>));</span><br><span class="line">				<span class="comment">// 修改记录指针所有记录、第2列的值</span></span><br><span class="line">				rs.updateString(<span class="number">2</span>, <span class="string">&quot;学生名&quot;</span> + i);</span><br><span class="line">				<span class="comment">// 提交修改</span></span><br><span class="line">				rs.updateRow();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">var</span> <span class="variable">rt</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResultSetTest</span>();</span><br><span class="line">		rt.initParam(<span class="string">&quot;mysql.ini&quot;</span>);</span><br><span class="line">		rt.query(<span class="string">&quot;select * from student_table&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>## 使用ResultSetMetaData分析结果集</p>
<p>如果程序需要了解ResultSet里包含哪些数据列，以及每个数据列的数据类型，可以通过ResultSetMetaData来获取关于ResultSet的描述信息。</p>
<p>ResultSet里包含一个getMetaData()方法，该方法返回该ResultSetMetaData对象，然后通过ResultSetMetaData提供的方法返回ResultSet的描述信息。常有方法有如下三个：</p>
<table>
<colgroup>
<col style="width: 43%" />
<col style="width: 34%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="header">
<th>函数原型</th>
<th>功能</th>
<th>参数</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>int getColumnCount()</td>
<td>返回该ResultSet的列的数量</td>
<td>无</td>
</tr>
<tr class="even">
<td>String getColumnName(int column)</td>
<td>返回指定索引的列名</td>
<td>column：指定索引</td>
</tr>
<tr class="odd">
<td>int getColumnType(int column)</td>
<td>返回指定索引列类型</td>
<td>column：指定索引</td>
</tr>
</tbody>
</table>
<p>## 使用RowSet 1.1 包装结果集</p>
<p>RowSet接口继承了ResultSet接口，RowSet接口包括JdbcRowSet、CachedRowSet、FilteredRowSet、JoinRowSet和WebRowSet常用子接口，其中JdbcRowSet需要保持与数据库的连接之外，其余四个子接口都是离线的RowSet,不需要保持与数据库的连接。</p>
<p>RowSet默认是可滚动、可更新、可序列化的结果集，对于离线的RowSet而言，程序在创建RowSet时已经把数据从底层数据库读取到了内存中，因此可以充分利用计算机的内存，从而降低数据库服务器的负载。</p>
<p>#### RowSetFactory与RowSet</p>
<p>RowSetProvider类负责创建RowSetFactory,而RowSetFactory提供以下方法创建RowSet实例。</p>
<ul>
<li>CachedRowSet createCachedRowSet()：创建一个默认的CachedRowSet。</li>
<li>FilterRowSet createFilterRowSet()：创建一个默认的FilterRowSet</li>
</ul></li>
</ul></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/Java/JDBC/%E6%89%A7%E8%A1%8CSQL%E8%AF%AD%E5%8F%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/Java/JDBC/%E6%89%A7%E8%A1%8CSQL%E8%AF%AD%E5%8F%A5/" class="post-title-link" itemprop="url">执行SQL语句</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 09:31:39 / 修改时间：16:54:23" itemprop="dateCreated datePublished" datetime="2022-05-11T09:31:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/java/" itemprop="url" rel="index"><span itemprop="name">Java基础</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="statement对象执行sql语句">Statement对象执行SQL语句</h2>
<ol type="1">
<li><p>使用executeLargeUpdate()方法执行DDL和DML语句</p>
<p>executeUpdate和executeLargeUpdate区别是如果受影响的行数超过了int最大值，则要使用后者。</p>
<p>例子：</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExecuteDDL</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">private</span> String driver;</span><br><span class="line">	<span class="keyword">private</span> String url;</span><br><span class="line">	<span class="keyword">private</span> String user;</span><br><span class="line">	<span class="keyword">private</span> String pass;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initParam</span><span class="params">(String paramFile)</span></span><br><span class="line">		<span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 使用Properties类来加载属性文件</span></span><br><span class="line">		<span class="type">var</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">		props.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(paramFile));</span><br><span class="line">		driver = props.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">		url = props.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">		user = props.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">		pass = props.getProperty(<span class="string">&quot;pass&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createTable</span><span class="params">(String sql)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 加载驱动</span></span><br><span class="line">		Class.forName(driver);</span><br><span class="line">		<span class="keyword">try</span> (</span><br><span class="line">			<span class="comment">// 获取数据库连接</span></span><br><span class="line">			<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, pass);</span><br><span class="line">			<span class="comment">// 使用Connection来创建一个Statment对象</span></span><br><span class="line">			<span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 执行DDL,创建数据表</span></span><br><span class="line">			stmt.executeUpdate(sql);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">var</span> <span class="variable">ed</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ExecuteDDL</span>();</span><br><span class="line">		ed.initParam(<span class="string">&quot;mysql.ini&quot;</span>);</span><br><span class="line">		ed.createTable(<span class="string">&quot;create table jdbc_test &quot;</span></span><br><span class="line">			+ <span class="string">&quot;( jdbc_id int auto_increment primary key, &quot;</span></span><br><span class="line">			+ <span class="string">&quot;jdbc_name varchar(255), &quot;</span></span><br><span class="line">			+ <span class="string">&quot;jdbc_desc text);&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;-----建表成功-----&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>使用execute方法执行SQL语句</p>
<p>execute方法可以执行任何SQL语句，但是很麻烦，通常没必要用此方法。但如果不清楚SQL语句类型，则可以使用此方法。</p>
<p>该方法返回值是boolean值，SQL语句返回结果集，则为true，否则为false。</p>
<p>在该方法执行以后，若是true，则返回值为结果集</p>
<p>可用<code>getResultSet()</code> 获取Statement执行查询语句的结果集</p>
<p>若返回值是false，则表明SQL语句是DDL或者DML，用</p>
<p><code>getUpdateCount()</code> 获取执行DML语句影响的行数</p>
<p>例子：</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExecuteSQL</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">private</span> String driver;</span><br><span class="line">	<span class="keyword">private</span> String url;</span><br><span class="line">	<span class="keyword">private</span> String user;</span><br><span class="line">	<span class="keyword">private</span> String pass;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initParam</span><span class="params">(String paramFile)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 使用Properties类来加载属性文件</span></span><br><span class="line">		<span class="type">var</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">		props.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(paramFile));</span><br><span class="line">		driver = props.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">		url = props.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">		user = props.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">		pass = props.getProperty(<span class="string">&quot;pass&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">executeSql</span><span class="params">(String sql)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 加载驱动</span></span><br><span class="line">		Class.forName(driver);</span><br><span class="line">		<span class="keyword">try</span> (</span><br><span class="line">			<span class="comment">// 获取数据库连接</span></span><br><span class="line">			<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url,</span><br><span class="line">				user, pass);</span><br><span class="line">			<span class="comment">// 使用Connection来创建一个Statement对象</span></span><br><span class="line">			<span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 执行SQL,返回boolean值表示是否包含ResultSet</span></span><br><span class="line">			<span class="type">boolean</span> <span class="variable">hasResultSet</span> <span class="operator">=</span> stmt.execute(sql);</span><br><span class="line">			<span class="comment">// 如果执行后有ResultSet结果集</span></span><br><span class="line">			<span class="keyword">if</span> (hasResultSet)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">try</span> (</span><br><span class="line">					<span class="comment">// 获取结果集</span></span><br><span class="line">					<span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> stmt.getResultSet())</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="comment">// ResultSetMetaData是用于分析结果集的元数据接口</span></span><br><span class="line">					<span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> rs.getMetaData();</span><br><span class="line">					<span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> rsmd.getColumnCount();</span><br><span class="line">					<span class="comment">// 迭代输出ResultSet对象</span></span><br><span class="line">					<span class="keyword">while</span> (rs.next())</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="comment">// 依次输出每列的值</span></span><br><span class="line">						<span class="keyword">for</span> (<span class="type">var</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; columnCount; i++)</span><br><span class="line">						&#123;</span><br><span class="line">							System.out.print(rs.getString(i + <span class="number">1</span>) + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">						&#125;</span><br><span class="line">						System.out.print(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				System.out.println(<span class="string">&quot;该SQL语句影响的记录有&quot;</span></span><br><span class="line">					+ stmt.getUpdateCount() + <span class="string">&quot;条&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">var</span> <span class="variable">es</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ExecuteSQL</span>();</span><br><span class="line">		es.initParam(<span class="string">&quot;mysql.ini&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;------执行删除表的DDL语句-----&quot;</span>);</span><br><span class="line">		es.executeSql(<span class="string">&quot;drop table if exists my_test&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;------执行建表的DDL语句-----&quot;</span>);</span><br><span class="line">		es.executeSql(<span class="string">&quot;create table my_test&quot;</span></span><br><span class="line">			+ <span class="string">&quot;(test_id int auto_increment primary key, &quot;</span></span><br><span class="line">			+ <span class="string">&quot;test_name varchar(255))&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;------执行插入数据的DML语句-----&quot;</span>);</span><br><span class="line">		es.executeSql(<span class="string">&quot;insert into my_test(test_name) &quot;</span></span><br><span class="line">			+ <span class="string">&quot;select student_name from student_table&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;------执行查询数据的查询语句-----&quot;</span>);</span><br><span class="line">		es.executeSql(<span class="string">&quot;select * from my_test&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p></li>
</ol>
<p>​</p>
<p>​</p>
<pre><code>## PreparedStatement对象执行SQL语句

如果要反复执行结构相同的SQL语句，可以用带占位符 ？参数的SQL语句来代替语句的不同地方

`insert into student_table values(null, ?, ?)`

可以用PreparedStatement来创建这样语句的对象，在执行语句之前，必须要为占位符传入对应参数值，用

`setXxx(int index, Xxx value)方法来传入参数值。

**如果清楚占位符参数对应数据类型，可以使用对应setXxx()传入参数值，若不知道对应数据类型，则用setObject()传入，PreparedStatement负责类型转换**。

例子：

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PreparedStatementTest</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">private</span> String driver;</span><br><span class="line">	<span class="keyword">private</span> String url;</span><br><span class="line">	<span class="keyword">private</span> String user;</span><br><span class="line">	<span class="keyword">private</span> String pass;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initParam</span><span class="params">(String paramFile)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 使用Properties类来加载属性文件</span></span><br><span class="line">		<span class="type">var</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">		props.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(paramFile));</span><br><span class="line">		driver = props.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">		url = props.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">		user = props.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">		pass = props.getProperty(<span class="string">&quot;pass&quot;</span>);</span><br><span class="line">		<span class="comment">// 加载驱动</span></span><br><span class="line">		Class.forName(driver);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertUseStatement</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">		<span class="keyword">try</span> (</span><br><span class="line">			<span class="comment">// 获取数据库连接</span></span><br><span class="line">			<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url,</span><br><span class="line">				user, pass);</span><br><span class="line">			<span class="comment">// 使用Connection来创建一个Statment对象</span></span><br><span class="line">			<span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 需要使用100条SQL语句来插入100条记录</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="type">var</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">			&#123;</span><br><span class="line">				stmt.executeUpdate(<span class="string">&quot;insert into student_table values(&quot;</span></span><br><span class="line">					+ <span class="string">&quot; null, &#x27;姓名&quot;</span> + i + <span class="string">&quot;&#x27;, 1)&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(<span class="string">&quot;使用Statement费时:&quot;</span></span><br><span class="line">				+ (System.currentTimeMillis() - start));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertUsePrepare</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">		<span class="keyword">try</span> (</span><br><span class="line">			<span class="comment">// 获取数据库连接</span></span><br><span class="line">			<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url,</span><br><span class="line">				user, pass);</span><br><span class="line">			<span class="comment">// 使用Connection来创建一个PreparedStatement对象</span></span><br><span class="line">			<span class="type">PreparedStatement</span> <span class="variable">pstmt</span> <span class="operator">=</span> conn.prepareStatement(</span><br><span class="line">				<span class="string">&quot;insert into student_table values(null, ?, 1)&quot;</span>))</span><br><span class="line"></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 100次为PreparedStatement的参数设值，就可以插入100条记录</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="type">var</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">			&#123;</span><br><span class="line">				pstmt.setString(<span class="number">1</span>, <span class="string">&quot;姓名&quot;</span> + i);</span><br><span class="line">				pstmt.executeUpdate();</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(<span class="string">&quot;使用PreparedStatement费时:&quot;</span></span><br><span class="line">				+ (System.currentTimeMillis() - start));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">var</span> <span class="variable">pt</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PreparedStatementTest</span>();</span><br><span class="line">		pt.initParam(<span class="string">&quot;mysql.ini&quot;</span>);</span><br><span class="line">		pt.insertUseStatement();</span><br><span class="line">		pt.insertUsePrepare();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></code></pre>
<p>使用PreparedStatement比使用Statement多了三个好处</p>
<ol type="1">
<li><p>PreparedStatement预编译SQL语句，性能更好</p></li>
<li><p>PreparedStatement不需要拼接SQL语句，编程更简单</p></li>
<li><p>PreparedStatement可以防止SQL注入，安全性更好。</p></li>
</ol>
<p>​</p>
<p>​</p>
<h2
id="使用callablestatement调用存储过程">使用CallableStatement调用存储过程</h2>
<p>通过Connection的prepareCall()来创建CallableStatement对象，创建时要传入调用存储对象的SQL语句，语句格式为
{call 过程名(?, ?,
?...)},问号作为存储过程参数的占位符，如下代码创建了调用存储过程的CallableStatement对象</p>
<p><code>cstmt = conn.prepareCall("&#123;call add_pro(?, ?, ?)&#125;")</code></p>
<p>传入参数可以通过 <code>setXxx()</code> 来传入参数 传出参数需要调用
<code>registerOutParameter()</code> 来注册该参数，实例代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注册CallableStatement的第三个参数是int类型</span></span><br><span class="line">cstmt.registerOutParameter(<span class="number">3</span>, Types.INTEGER)</span><br></pre></td></tr></table></figure>
<p>调用存储过程实例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CallableStatementTest</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">private</span> String driver;</span><br><span class="line">	<span class="keyword">private</span> String url;</span><br><span class="line">	<span class="keyword">private</span> String user;</span><br><span class="line">	<span class="keyword">private</span> String pass;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initParam</span><span class="params">(String paramFile)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 使用Properties类来加载属性文件</span></span><br><span class="line">		<span class="type">var</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">		props.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(paramFile));</span><br><span class="line">		driver = props.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">		url = props.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">		user = props.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">		pass = props.getProperty(<span class="string">&quot;pass&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">callProcedure</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// 加载驱动</span></span><br><span class="line">		Class.forName(driver);</span><br><span class="line">		<span class="keyword">try</span> (</span><br><span class="line">			<span class="comment">// 获取数据库连接</span></span><br><span class="line">			<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, pass);</span><br><span class="line">			<span class="comment">// 使用Connection来创建一个CallableStatment对象</span></span><br><span class="line">			<span class="type">CallableStatement</span> <span class="variable">cstmt</span> <span class="operator">=</span> conn.prepareCall(</span><br><span class="line">				<span class="string">&quot;&#123;call add_pro(?, ?, ?)&#125;&quot;</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			cstmt.setInt(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line">			cstmt.setInt(<span class="number">2</span>, <span class="number">5</span>);</span><br><span class="line">			<span class="comment">// 注册CallableStatement的第三个参数是int类型</span></span><br><span class="line">			cstmt.registerOutParameter(<span class="number">3</span>, Types.INTEGER);</span><br><span class="line">			<span class="comment">// 执行存储过程</span></span><br><span class="line">			cstmt.execute();</span><br><span class="line">			<span class="comment">// 获取，并输出存储过程传出参数的值。</span></span><br><span class="line">			System.out.println(<span class="string">&quot;执行结果是: &quot;</span> + cstmt.getInt(<span class="number">3</span>));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">var</span> <span class="variable">ct</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CallableStatementTest</span>();</span><br><span class="line">		ct.initParam(<span class="string">&quot;mysql.ini&quot;</span>);</span><br><span class="line">		ct.callProcedure();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/Java/JDBC/JDBC%E7%BC%96%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/Java/JDBC/JDBC%E7%BC%96%E7%A8%8B/" class="post-title-link" itemprop="url">JDBC常用接口和类及其编程步骤</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 09:30:39 / 修改时间：16:54:31" itemprop="dateCreated datePublished" datetime="2022-05-11T09:30:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/java/" itemprop="url" rel="index"><span itemprop="name">Java基础</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="常用接口和类及其简介">常用接口和类及其简介</h2>
<ol type="1">
<li><p>DriverManager：用于管理JDBC驱动的服务类，该类主要功能是获取Connection对象，从而连接数据库。</p>
<p>常用方法：</p>
<table>
<colgroup>
<col style="width: 45%" />
<col style="width: 15%" />
<col style="width: 39%" />
</colgroup>
<thead>
<tr class="header">
<th>函数原型</th>
<th>功能</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>public static Connection getConnection(String url,String user,
String pass)</td>
<td>与指定数据库进行连接</td>
<td>url:数据库端口<br />user：用户名<br />pass：用户密码</td>
</tr>
</tbody>
</table></li>
<li><p>Connection：代表数据库连接对象，每个Connection对象代表一个物理连接会话，要想访问数据库，必须先获得数据库连接。</p>
<p>常用方法：</p>
<table>
<colgroup>
<col style="width: 48%" />
<col style="width: 38%" />
<col style="width: 12%" />
</colgroup>
<thead>
<tr class="header">
<th>函数原型</th>
<th>功能</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Statement createStatement()</td>
<td>返回一个新创建的Statement对象</td>
<td>无</td>
</tr>
<tr class="even">
<td>PreparedStatement prepareStatement(String sql)</td>
<td>返回一个新创建的PreparedStatement对象</td>
<td>sql：SQL语句</td>
</tr>
<tr class="odd">
<td>CallableStatement prepareCall(String sql)</td>
<td>返回一个新创建的CallableStatement对象</td>
<td>sql：SQL语句</td>
</tr>
</tbody>
</table>
<p>控制事务的方法：</p>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 20%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="header">
<th>函数原型</th>
<th>功能</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Savepoint setSavepoint()</td>
<td>创建一个保存点</td>
<td>无</td>
</tr>
<tr class="even">
<td>Savepoint setSavepoint(String name)</td>
<td>以指定的名字创建一个保存点</td>
<td>name：指定保存点的名字</td>
</tr>
<tr class="odd">
<td>void rollback(Savepoint savepoint)</td>
<td>将事务会滚到指定保存点</td>
<td>savepoint:指定保存点</td>
</tr>
<tr class="even">
<td>void rollback()</td>
<td>回滚事务</td>
<td>无</td>
</tr>
<tr class="odd">
<td>void setAutoCommit(boolean autoCommit)</td>
<td>设置自动提交，即设置事务</td>
<td>autoCommit:当为false时，关闭自动提交，打开事务<br />当为true，打开自动提交，关闭事务。<br /></td>
</tr>
<tr class="even">
<td>void commit()</td>
<td>提交事务</td>
<td>无</td>
</tr>
</tbody>
</table></li>
<li><p>Statement：用于执行SQL语句的工具接口，该对象既可用于执行DDL、DCL语句，也可用于执行DML语句，还可用于SQL查询，当执行SQL查询时，返回查询得到的结果集。</p>
<p>常用方法：</p>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 54%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="header">
<th>函数原型</th>
<th>功能</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ResultSet executeQuery(String sql)</td>
<td>执行查询语句，并返回查询结果</td>
<td>sql：查询语句</td>
</tr>
<tr class="even">
<td>int executeUpdate(String sql)</td>
<td>执行DML，返回受影响行数,也可用于执行DDL语句,返回0</td>
<td>sql:DML或DDL语句</td>
</tr>
<tr class="odd">
<td>boolean execute(String sql)</td>
<td>执行任何SQL语句，如果执行后第一个结果为ResultSet，返回true<br />如果为受影响行数或没有结果，返回0</td>
<td>sql：SQL语句</td>
</tr>
</tbody>
</table></li>
<li><p>PreparedStatement:预编译的对象。PreparedStatement是Statement的子接口，它允许数据库预编译SQL语句(这些SQL语句通常带有参数)，以后每次只改变SQL命令的参数，不用重新编译，性能更好。</p>
<p>常用方法：</p>
<p><code>void setXxx(int parameterIndex, Xxx value)</code></p>
<p>该方法根据传入参数值的类型不同，需要使用不同的方法，传入的值根据索引传给SQ语句指定位置的参数。</p>
<p>#### 注意</p>
<p>PreparedStatement同样有上述Statement的方法，只不过没有参数sql，因为PreparedStatement已经预编译了SQL命令。</p></li>
<li><p>ResultSet：结果集对象，该对象包含访问查询结果的方法。</p>
<p>常用方法：</p>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 56%" />
<col style="width: 19%" />
</colgroup>
<thead>
<tr class="header">
<th>函数原型</th>
<th>功能</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>void close()</td>
<td>释放结果集对象</td>
<td>无</td>
</tr>
<tr class="even">
<td>boolean absolute(int row)</td>
<td>将结果集的记录指针移动到第row行<br />如果row为负数，则移到倒数第row行</td>
<td>row：指定对应行的位置</td>
</tr>
<tr class="odd">
<td>void beforeFirst()</td>
<td>将记录指针移动到首行之前，如果所指记录<br />是有效记录，返回true，否则返回false</td>
<td>无</td>
</tr>
<tr class="even">
<td>boolean first()</td>
<td>将记录指针移动到第一行，返回值同上</td>
<td>无</td>
</tr>
<tr class="odd">
<td>boolean previous()</td>
<td>将记录指针移动到上一行，返回值同上</td>
<td>无</td>
</tr>
<tr class="even">
<td>boolean next()</td>
<td>移动至下一行，返回值同上</td>
<td>无</td>
</tr>
<tr class="odd">
<td>boolean last()</td>
<td>移动至最后一行，返回值同上</td>
<td>无</td>
</tr>
<tr class="even">
<td>void afterLast()</td>
<td>记录指针移动至最后一行之后</td>
<td>无</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>#### 注意</p>
<p>结果集行从1开始。</p></li>
</ol>
<h2 id="jdbc编程步骤">JDBC编程步骤</h2>
<ol type="1">
<li><p>加载数据库驱动：通常使用Class类的forName()静态方法加载驱动。</p>
<p><code>Class.forName(driverClass)</code></p>
<p>driverClass就是数据库驱动类对应字符串，不同数据库系统是不同的。</p>
<p>加载MySQL驱动：<code>Class.forName("com.mysql.cj.jdbc.Driver")</code></p></li>
<li><p>通过DriverManager获取数据库连接</p>
<p><code>DriverManager.getConnection(String url, String user, String
pass)</code></p>
<p>参数分别为：数据库URL, 登陆数据库用户名和密码</p>
<p>URL遵循如下写法：</p>
<p>jdbc:subprotocol:other stuff</p>
<p>MySQL数据库URL写法为：jdbc:mysql://hostname:port/databasename</p>
<p>其中，hostname是数据库主机名称，在本机上就是localhost</p>
<p>port就是端口，是3306，databasename就是要使用的数据库。</p></li>
<li><p>通过Connection对象创建Statement对象，创建方法有三个：</p>
<table>
<colgroup>
<col style="width: 34%" />
<col style="width: 51%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="header">
<th>函数原型</th>
<th>功能</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>createStatement()</td>
<td>创建基本的Statement对象</td>
<td>无</td>
</tr>
<tr class="even">
<td>prepareStatement(String sql)</td>
<td>根据传入的SQL语句创建预编译的Statement对象</td>
<td>sql：SQL语句</td>
</tr>
<tr class="odd">
<td>prepareCall(String sql)</td>
<td>根据传入的SQL语句创建CallableStatement对象</td>
<td>sql：SQL语句</td>
</tr>
</tbody>
</table></li>
<li><p>使用Statement对象执行SQL语句，所有Statement对象都有三个方法执行SQL语句</p>
<table>
<colgroup>
<col style="width: 37%" />
<col style="width: 50%" />
<col style="width: 12%" />
</colgroup>
<thead>
<tr class="header">
<th>函数原型</th>
<th>功能</th>
<th>参数说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>execute()</td>
<td>可以执行任何SQL语句，但比较麻烦</td>
<td>无</td>
</tr>
<tr class="even">
<td>executeUpdate()</td>
<td>主要执行DML和DDL语句</td>
<td>无</td>
</tr>
<tr class="odd">
<td>ResultSet executeQuery()</td>
<td>只能执行查询语句，返回查询结果集</td>
<td>无</td>
</tr>
</tbody>
</table></li>
<li><p>操作结果集。如果是查询语句，可以操作ResultSet对象取出查询结果，并进行操作。</p>
<p>除了上述ResultSet常用操作方法外，还有一个：</p>
<p><code>getXxx()</code>
该方法获取记录指针指向的行，特定列的值，可以传入列索引为参数，也可以传入列名为参数。</p>
<p><strong>列索引从1开始</strong>。</p></li>
<li><p>回收数据库资源：包括关闭ResultSet资源、Statement和Connection资源。</p>
<ol type="1">
<li><p>推荐将这些对象的定义放在try块，程序会自动回收。</p></li>
<li><p>也可以使用对象的close()方法。</p></li>
</ol></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E5%92%8C%E5%8F%8D%E5%B0%84/3-%E9%80%9A%E8%BF%87%E5%8F%8D%E5%B0%84%E6%9F%A5%E7%9C%8B%E7%B1%BB%E4%BF%A1%E6%81%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E5%92%8C%E5%8F%8D%E5%B0%84/3-%E9%80%9A%E8%BF%87%E5%8F%8D%E5%B0%84%E6%9F%A5%E7%9C%8B%E7%B1%BB%E4%BF%A1%E6%81%AF/" class="post-title-link" itemprop="url">通过反射查看类信息</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 09:24:39 / 修改时间：16:53:46" itemprop="dateCreated datePublished" datetime="2022-05-11T09:24:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/java/" itemprop="url" rel="index"><span itemprop="name">Java基础</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Java程序许多对象运行时会出现两种类型：编译时类型、运行时类型。</p>
<p>例如<code>Person p = new
Student();</code>，在编译时p变量是Person类型，运行时是Student类型。</p>
<p>但程序又需要调用该对象运行时类型的方法。</p>
<p>为了解决这个问题，程序需要在运行时发现对象和类的真实信息，有两种方法</p>
<ul>
<li>第一种是假设在编译和运行时都完全知道类型的具体信息，可以使用instanceof运算符进行判断，再利用强制类型转换，转换为运行时类型的变量。</li>
<li>第二种是程序只能依靠运行时来发现该对象和类的真实信息，只能用反射。</li>
</ul>
<h2 id="获得class对象">获得Class对象</h2>
<p>每个类被加载，系统都会为该类生成一个对应的Class对象，通过该Class对象就可以访问到JVM中的这个类，在Java程序中获得Class对象通常有三种方式。</p>
<ol type="1">
<li>使用Class类的forName(String
className)静态方法，参数是某个类的全限定类名</li>
<li>调用某个类的class属性来获取该类对应Class对象</li>
<li>调用某个对象的getClass方法，该方法是Object类的一个方法，所有Java对象都可以调用。</li>
</ol>
<p>对于第一种和第二种方法，都是直接根据类来获取Class对象。相比之下，第二种有两种优势。</p>
<ol type="1">
<li>代码更安全，程序在编译阶段就可以检查需要访问的Class对象是否存在</li>
<li>性能更好，无需调用方法</li>
</ol>
<p>大部分时候，都应该使用第二种方法来获取类的Class对象。如果程序只能获得一个字符串"java..lang.String"，只能使用第一种方式。</p>
<p>一旦获得某个类对象的Class对象之后，就可以调用方法来获取该对象和该类的真实信息了。</p>
<h2 id="从class中获取信息">从Class中获取信息</h2>
<p>Class对象有贼拉多的方法来获取信息。每个方法都可能包括重载的版本。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E5%92%8C%E5%8F%8D%E5%B0%84/2-%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E5%92%8C%E5%8F%8D%E5%B0%84/2-%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/" class="post-title-link" itemprop="url">2-类加载器</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 09:23:39 / 修改时间：16:53:43" itemprop="dateCreated datePublished" datetime="2022-05-11T09:23:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/java/" itemprop="url" rel="index"><span itemprop="name">Java基础</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="类加载机制">类加载机制</h2>
<p>类加载器负责加载所有的类，一旦一个类被载入JVM中，同一个类就不会被再次载入了，那么，怎么才算“同一个类”。</p>
<p>正如一个对象有一个唯一标识，一个载入JVM的类也有一个唯一的标识。在Java中，用全限定类名作为标识；但在JVM中，一个类用全限定类名和类加载器作为唯一标识。例如，Person类的example包中，被类加载器ClassLoader的实例a所加载，它在JVM中表示为(Person,
example, a)。这意味着两个类加载器加载的同名类也是不同的。</p>
<p>​ 当JVM启动时，会形成三个类加载器组成的初始类加载器层次结构：</p>
<ul>
<li>BootStrap ClassLoader：根类加载器</li>
<li>Extension ClassLoader：拓展类加载器</li>
<li>System ClassLoader：系统类加载器</li>
</ul>
<p>BootStrap ClassLoader被称为引导类加载器，负责加载Java的核心类。</p>
<p>JVM的类加载机制有三种：</p>
<ul>
<li>全盘负责：当一个类加载器负责加载某个Class时，该Class所依赖的和引用的其他Class也将由该类加载器负责载入，除非是显式使用另外一个类加载器</li>
<li>父类委托：是先让父类加载器试图加载该Class，只有在父类加载器无法加载该类时才尝试从自己类路径加载该类。</li>
<li>缓存机制：缓存机制保证所有加载过的Class都会被缓存，当程序需要使用某个Class时，类加载器先从缓存区搜寻该Class，当缓存区没有，系统才会读取该类对应二进制文件，并转换为Class对象，存入缓存区。这是为什么修改Class后，必须重新启动JVM，修改才会生效的原因。</li>
</ul>
<p>类加载器之间的父子关系不是类继承上的父子关系。这里的父子关系是指类加载器实例之间的关系。</p>
<p>根类加载器-&gt;拓展类加载器-&gt;系统类加载器-&gt;用户类加载器</p>
<p>JVM的根类加载器不是由Java实现的，而且程序一般不会访问根类加载器。</p>
<p>类加载器加载Class大概需要8个步骤：</p>
<ol type="1">
<li>检测此Class是否载入过，如果有，到第8步；没有执行第2步</li>
<li>如果父类加载器不存在(没有父类加载器，那么要么parent是根类加载器，要么自己本身就是根类加载器)，执行第四步；如果父类加载器存在，到第3步</li>
<li>请求使用父类加载器载入目标类，成功载入，则到第8步；否则执行第5步</li>
<li>请求使用根类加载器载入目标类，成功载入，到第8步；否则执行第7步</li>
<li>当前类加载器尝试寻找Class文件(从与此ClassLoader相关的类路径寻找)，如果找到执行第6步；找不到执行第7步</li>
<li>从文件中载入Class，成功载入后跳到第8步</li>
<li>抛出ClassNotFoundException异常</li>
<li>返回对应java.lang.Class对象</li>
</ol>
<p>其中，第5、6步允许重写ClassLoader的findClass()方法来实现自己的载入策略，甚至重写loadClass实现自己的载入过程。</p>
<h2 id="创建并使用自定义的类加载器">创建并使用自定义的类加载器</h2>
<p>JVM中除了根类加载器之外的所有类加载器都是ClassLoader子类的实例。开发者可以拓展ClassLoader的子类，重写相应方法来实现自定义的类加载器。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E5%92%8C%E5%8F%8D%E5%B0%84/1-%20%E7%B1%BB%E7%9A%84%E5%8A%A0%E8%BD%BD%E3%80%81%E8%BF%9E%E6%8E%A5%E5%92%8C%E5%88%9D%E5%A7%8B%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E5%92%8C%E5%8F%8D%E5%B0%84/1-%20%E7%B1%BB%E7%9A%84%E5%8A%A0%E8%BD%BD%E3%80%81%E8%BF%9E%E6%8E%A5%E5%92%8C%E5%88%9D%E5%A7%8B%E5%8C%96/" class="post-title-link" itemprop="url">1- 类的加载、连接和初始化</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 09:22:39 / 修改时间：16:53:41" itemprop="dateCreated datePublished" datetime="2022-05-11T09:22:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/java/" itemprop="url" rel="index"><span itemprop="name">Java基础</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>这一部分会介绍java.lang.reflect包下的接口和类，包括Class、Method、Field、Constructor和Array，这些类分别代表类、方法、变量、构造器和数组。Java程序可以使用这些类动态的获取某个对象、某个类的运行时信息，可以动态，的创建Java对象，动态调用Java方法，访问并修改对象的成员变量值。还有该包下的两个接口，Type是Class类实现的接口，ParameterizedType则代表带泛型参数的类型。</p>
<p>也介绍使用Proxy和InvocationHandler来创建JDK动态代理。和JDK动态代理和AOP的内在关系。</p>
<h2 id="jvm和类">JVM和类</h2>
<p>当运行某个java程序时，会启动一个java虚拟机进程，不管该Java程序有多么复杂，有多少线程，他们都处于Java虚拟机进程中，同一个JVM的所有线程、所有变量都使用JVM进程的内存区。</p>
<p>当系统出现以下几种情况，JVM进程被终止：</p>
<ul>
<li>程序运行到正常结束</li>
<li>程序运行到System.exit()或Runtime.getRuntime().exit()代码</li>
<li>程序执行过程中遇到未捕获的异常或错误而结束</li>
<li>程序所在平台强制结束了JVM进程</li>
</ul>
<h2 id="类的加载">类的加载</h2>
<p>当程序使用某个类时，如果该类还未被加载到内存中，系统会通过加载、连接、初始化三个步骤来对该类进行初始化，没有意外的话，JVM会连续完成这三个步骤，所以也统称为类加载或类初始化。</p>
<p>类加载是指将该类的class文件读入内存，<strong>并为之创建一个java.lang.Class对象</strong>，也就是说当程序中使用任何类时，系统都会为之建立一个java.lang.Class文件。</p>
<p>类的加载由类加载器完成，类加载器通常由JVM提供。JVM提供的类加载器通常称为系统类加载器，除此，开发者可以继承ClassLoader基类来创建自己的类加载器。</p>
<p>通过使用不用的类加载器，可以从不同来源加载类的二进制数据，通常由以下几种来源：</p>
<ul>
<li>从本地文件中加载class文件，这是最常用的</li>
<li>从JAR包加载class文件，这种也很常见，导入的jar包就是使用这种方式，例如JDBC编程用到的驱动类jar包</li>
<li>通过网络加载class文件</li>
<li>把一个Java源文件动态编译、并执行加载</li>
</ul>
<p>类加载器无需等到 首次使用该类
才加载，Java虚拟机允许系统预先加载某些类。</p>
<h2 id="类的连接">类的连接</h2>
<p>当类被加载后，系统为之生成一个对应的Class对象，然后进入连接阶段，连接阶段负责把类的二进制数据合并到JRE中，连接又可分为三个阶段：</p>
<ul>
<li>验证：用于检验被加载的类是否有正确的内部结构，并和其他类协调一致</li>
<li>准备：负责为类的类变量分配内存，并设置默认初始值</li>
<li>解析：将类的二进制数据中的符号引用转换为直接饮用</li>
</ul>
<h2 id="类的初始化">类的初始化</h2>
<p>虚拟机对类负责初始化，主要就是对类变量进行初始化，Java类变量指定初始值有两种方式：</p>
<ol type="1">
<li>声明类变量时指定初始值</li>
<li>使用静态初始化块指定初始值</li>
</ol>
<p>JVM初始化一个类包括几个步骤：</p>
<ul>
<li>假如这个类还没有被加载和连接，程序先加载并连接该类</li>
<li>假如该类的直接父类还没有被初始化，则先初始化该直接父类</li>
<li>假如类中有初始化语句，系统则依次执行这些初始化语句</li>
</ul>
<p>注意：当执行第二个步骤时，系统对直接父类的初始化也遵循这三个步骤，如果该直接父类的父类也没有被初始化，那么系统会先初始化父类的直接父类，以此类推。所以JVM最先初始化的总是Object类。</p>
<h3 id="类初始化的时机">类初始化的时机</h3>
<p>当Java程序首次通过下面6种方式来使用某个类或接口时，系统会初始化该类或接口。</p>
<ul>
<li>创建类的实例。包括，使用new操作符来创建实例，通过反射来创建实例，通过反序列化创建实例</li>
<li>调用某个类的类方法</li>
<li>访问某个类的类变量，或为该类变量赋值</li>
<li>使用反射强制创建某个类或接口对应的Class对象，例如<code>Class.forName("Person")</code>，如果系统未初始化Person类，那么这行代码会导致Person类被初始化，并返回对应的Class对象。</li>
<li>初始化某个类的子类</li>
<li>直接使用java.exe命令来运行某个主类</li>
</ul>
<p><strong>注意：</strong>除此之外。对于final型的类变量，如果该类变量的值在编译时就可确定下来，那么这个类变量相当于宏变量，java编译器会在编译时直接把这个类变量出现的地方替换成它的值，因此即使程序使用该静态变量，也不会导致该类初始化。</p>
<p>​
如果final类变量在编译时不能确定下来，必须等到运行时才可确定，如果通过该类访问类变量，会导致该类被初始化。</p>
<p>当使用ClassLoader加载该类时，并不会导致该类的初始化，它加载该类。当使用Class.forName()静态方法才会初始化该类。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/Java/%E6%B3%9B%E5%9E%8B/%E7%B1%BB%E5%9E%8B%E9%80%9A%E9%85%8D%E7%AC%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/Java/%E6%B3%9B%E5%9E%8B/%E7%B1%BB%E5%9E%8B%E9%80%9A%E9%85%8D%E7%AC%A6/" class="post-title-link" itemprop="url">类型通配符</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 09:20:39 / 修改时间：16:53:21" itemprop="dateCreated datePublished" datetime="2022-05-11T09:20:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/java/" itemprop="url" rel="index"><span itemprop="name">Java基础</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>我们知道，String类是Object类的子类，但是List<String>不是List<Object>的子类，所以如果在方法中定义形参List<Object>，我们是不能把List<String>赋给这个形参的。</p>
<p>但是如果Foo是Bar的一个子类，那么Foo[]可以直接赋给Bar[]，但是G<Foo>不是G<Bar>的子类型。Foo[]自动向上转型为Bar[]的方式称为型变，也就是说Java的数组支持型变，但是Java集合不支持。</p>
<h2 id="使用类型通配符">使用类型通配符</h2>
<p>为了表达各种泛型List的父类，可以使用类型通配符，类型通配符是一个问号
?
，将一个问号作为类型实参传给List集合，写作：List&lt;?&gt;，意思是元素类型未知的List，这个问号称为通配符，它的元素类型可以匹配任何类型。</p>
<p>但这种带通配符的List仅仅表示它是各种泛型List的父类，不能把元素加入其中。</p>
<h2 id="设定类型通配符的上限">设定类型通配符的上限</h2>
<p>有一种特殊情形，程序不希望这个List&lt;?&gt;是任何泛型List的父类，只希望它代表某一类泛型List的父类。</p>
<p>例如定义三个形状类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(Canvas c)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Circle</span> <span class="keyword">extends</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">draw</span><span class="params">(Canvas c)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;在画布&quot;</span> + c + <span class="string">&quot;上画一个圆&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;把一个矩形画在画布&quot;</span> + c + <span class="string">&quot;上&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Canvas</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">drawAll</span><span class="params">(List&lt;Shape&gt; shapes)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> s :shapes)&#123;</span><br><span class="line">            s.draw(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面drawAll方法的形参是List<Shape>，所以不能把List<Circle>和List<Rectangle>传入，为了表示List<Circle>的父类，可以使用List&lt;?
extends Shape&gt;，并且把Canvas改为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Canvas</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">drawAll</span><span class="params">(List&lt;? extends Shape&gt; shapes)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span>(Shape s :shapes)&#123;</span><br><span class="line">            s.draw(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就可以把List<Circle>对象当成List&lt;? extends
Shape&gt;使用。Shape就称为这个通配符的上限。</p>
<p>此处问号代表一个未知的类型，但是这个类型一定是Shape的子类型，由于程序无法确定这个受限制的通配符的具体类型，所以不能把Shape对象或者子类的对象加入到这个泛型集合。</p>
<p>因为程序无法确定这个类型是什么，所以没法加入。</p>
<p>简而言之，这种指定通配符上限的集合，<strong>只能取元素(取出的元素总是上限的类型或者其子类)，不能向集合中添加元素。</strong></p>
<p>对于更广泛的泛型类，指定通配符上限就是为了支持类型型变，比如Foo是Bar的子类，这样A<Foo>就相当于A&lt;?
extends Bar&gt;的子类，可以将A<Foo>直接赋值给A&lt;? extends
Bar&gt;类型的变量，<strong>这种型变方式称为协变。</strong></p>
<p>对于协变的泛型而言，他只能调用泛型类型作为返回值类型的方法(编译器会将该方法返回值当成通配符上限的类型)，而不能调用泛型类型作为参数的方法，口诀是<strong>只出不进。</strong></p>
<h2 id="设定类型通配符下限">设定类型通配符下限</h2>
<p>Java的通配符下限使用&lt;? super
类型&gt;的方式来制定，下限的作用于上限的作用刚好相反。</p>
<p>制定通配符的下限是为了支持类型型变，比如Foo是Bar的子类，当程序需要一个A&lt;?
super
Foo&gt;的变量时，可以把A<Bar>、A<Object>赋值给它，这种型变方式称为逆变。</p>
<p>对于逆变的泛型集合来说，编译器只知道集合元素是下限的父类型或者该下限，但是具体哪种不知道，所以这种逆变的泛型集合只能向其中添加元素(因为实际赋值的集合元素总是逆变声明的父类，可以向上造型)，但从集合取元素时，只能被当成Object类型处理。</p>
<p>对于逆变的泛型来说，口诀是<strong>只进不出</strong>。要出只能被当成Object类型处理，需要强制类型转换。</p>
<h2 id="设定泛型形参的上限">设定泛型形参的上限</h2>
<p>Java泛型不仅允许在使用通配符时设定上限，而且可以在定义泛型形参的时候设定上限，用于表示传给该泛型形参的实际类型要么是该上限类型要么是该上限类型的子类。</p>
<p>对于更极端的情况，程序需要为泛型接口设定多个上限(至多有一个父类上限，多个接口上限)，那么所有接口上限必须位于类上限的后面。</p>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Apple</span>&lt;T <span class="keyword">extends</span> <span class="title class_">Number</span> &amp; java.io.Serializable&gt;&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/Java/%E6%B3%9B%E5%9E%8B/%E6%B3%9B%E5%9E%8B%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/Java/%E6%B3%9B%E5%9E%8B/%E6%B3%9B%E5%9E%8B%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">泛型方法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 09:19:39 / 修改时间：16:53:13" itemprop="dateCreated datePublished" datetime="2022-05-11T09:19:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/java/" itemprop="url" rel="index"><span itemprop="name">Java基础</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在一些情况下，定义类、接口时没有使用泛型形参，但定义方法时想自己定义泛型形参，这也可以，Java提供了对泛型方法的支持。</p>
<p>假设需要实现这样一个方法，将Object数组的所有元素都放入Collection集合里，可以考虑代码为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">fromArrayToCollection</span><span class="params">(Object[] a, Collection&lt;Object&gt; c)</span></span><br><span class="line">&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面方法没有问题，关键在于c形参，它的泛型形参是Object，因为Collection<String>不是Object<Object>的子类，所以这个方法功能十分有限，他只能将Object[]数组的元素复制到Collection集合里，但是Object的子类不行。</p>
<p>使用类型通配符也不行，因为Java不允许把对象放进一个未知类型的集合中。</p>
<p>我们可以使用泛型方法，所谓泛型方法，就是在声明方法时，定义一个或多个泛型形参，语法格式为</p>
<p>修饰符 &lt;T, S&gt; 返回值类型 方法名(形参列表){方法体};</p>
<p>泛型方法与普通方法实际上就是多了泛型形参声明，放在修饰符和返回值类型之间，这样就可以把上面方法改为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">fromArrayToCollection</span><span class="params">(T[] a, Collection&lt;T&gt; c)</span></span><br><span class="line">&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GenericMethodTest</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// 声明一个泛型方法，该泛型方法中带一个T泛型形参，</span></span><br><span class="line">	<span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">fromArrayToCollection</span><span class="params">(T[] a, Collection&lt;T&gt; c)</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (T o : a)</span><br><span class="line">		&#123;</span><br><span class="line">			c.add(o);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">var</span> <span class="variable">oa</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">100</span>];</span><br><span class="line">		Collection&lt;Object&gt; co = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">		<span class="comment">// 下面代码中T代表Object类型</span></span><br><span class="line">		fromArrayToCollection(oa, co);</span><br><span class="line">		<span class="type">var</span> <span class="variable">sa</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">100</span>];</span><br><span class="line">		Collection&lt;String&gt; cs = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">		<span class="comment">// 下面代码中T代表String类型</span></span><br><span class="line">		fromArrayToCollection(sa, cs);</span><br><span class="line">		<span class="comment">// 下面代码中T代表Object类型</span></span><br><span class="line">		fromArrayToCollection(sa, co);</span><br><span class="line">		<span class="type">var</span> <span class="variable">ia</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Integer</span>[<span class="number">100</span>];</span><br><span class="line">		<span class="type">var</span> <span class="variable">fa</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Float</span>[<span class="number">100</span>];</span><br><span class="line">		<span class="type">var</span> <span class="variable">na</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Number</span>[<span class="number">100</span>];</span><br><span class="line">		Collection&lt;Number&gt; cn = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">		<span class="comment">// 下面代码中T代表Number类型</span></span><br><span class="line">		fromArrayToCollection(ia, cn);</span><br><span class="line">		<span class="comment">// 下面代码中T代表Number类型</span></span><br><span class="line">		fromArrayToCollection(fa, cn);</span><br><span class="line">		<span class="comment">// 下面代码中T代表Number类型</span></span><br><span class="line">		fromArrayToCollection(na, cn);</span><br><span class="line">		<span class="comment">// 下面代码中T代表Object类型</span></span><br><span class="line">		fromArrayToCollection(na, co);</span><br><span class="line">		<span class="comment">// 下面代码中T代表String类型，但na是一个Number数组，</span></span><br><span class="line">		<span class="comment">// 因为Number既不是String类型，</span></span><br><span class="line">		<span class="comment">// 也不是它的子类，所以出现编译错误</span></span><br><span class="line"><span class="comment">//		fromArrayToCollection(na, cs);</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>类、接口声明中定义的泛型参数可以在整个类、接口中使用，方法中的泛型参数只能在该方法中使用。</p>
<p>与类、接口中使用泛型参数不同的是，方法中的泛型参数无序显式传入实际类型参数，如上例定义的方法，不需要在调用方法前传入String、Object等类型，系统依然可以知道为泛型实际传入的类型。</p>
<p>##　泛型方法和类型通配符的区别</p>
<p>大多数时候都可用泛型方法来代替类型通配符。</p>
<p><strong>泛型方法允许泛型形参被用来表示方法的一个或多个参数之间的类型依赖关系，或者方法返回值与参数之间的依赖关系，如果没有这样的依赖关系，就不应该使用泛型方法。</strong></p>
<p>当然也可以同时使用泛型方法和通配符，例如</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Collections</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">void</span> <span class="title function_">copy</span><span class="params">(List&lt;T&gt; dest, List&lt;? extends T&gt; src)</span></span><br><span class="line">    &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面方法的dest和scr存在明显依赖关系，从scr复制出来的元素可以丢进dest中，这里使用通配符是因为：该方法不需要向src集合添加元素，也不需要修改src集合的元素，所以使用类型通配符，不需要使用泛型方法。</p>
<p>当然，也可以将上面方法改为完全使用泛型方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Collections</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> &lt;T, S <span class="keyword">extends</span> <span class="title class_">T</span>&gt; <span class="keyword">void</span> <span class="title function_">copy</span><span class="params">(List&lt;T&gt; dest, List&lt;S&gt; src)</span>&#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个可以代替前面的方法，但注意泛型形参S，他仅仅使用了一次，其他参数的类型、方法返回值的类型都不依赖于它，因此S没有存在的必要，可以用通配符来代替S。</p>
<p>类型通配符与泛型方法(在方法签名中显式声明泛型形参)还有一个显著区别：类型通配符既可以在方法签名中定义形参类型，也可以用于定义变量的类型；但是泛型方法中的泛型形参必须在对应方法中显式声明。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/14/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><span class="page-number current">15</span><a class="page-number" href="/page/16/">16</a><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/16/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZhaoXin</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
