<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"zhaoquaner.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="赵圈儿的博客">
<meta property="og:url" content="https://zhaoquaner.github.io/page/13/index.html">
<meta property="og:site_name" content="赵圈儿的博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ZhaoXin">
<meta property="article:tag" content="博客">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://zhaoquaner.github.io/page/13/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/13/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>赵圈儿的博客</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">赵圈儿的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">23</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">18</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">169</span></a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ZhaoXin"
      src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
  <p class="site-author-name" itemprop="name">ZhaoXin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">169</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/zhaoquaner" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zhaoquaner" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zx1522202417@163.com" title="E-Mail → mailto:zx1522202417@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/JavaWeb/JQuery/3-JQuery%20DOM%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/JavaWeb/JQuery/3-JQuery%20DOM%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">3-JQuery DOM操作</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 13:49:39 / 修改时间：16:55:03" itemprop="dateCreated datePublished" datetime="2022-05-11T13:49:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/javaweb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>JQuery提供了一系列与DOM相关的方法，可以访问和操作HTML元素和属性。</p>
<h2 id="获取内容和属性">获取内容和属性</h2>
<p>三个实用的用于获取内容的JQuery方法(<strong>设置时，有参数；返回时，无参数</strong>)：</p>
<ul>
<li>text()：设置或返回所选元素的文本内容</li>
<li>html()：设置或返回所选元素的内容(包括HTML标记)</li>
<li>val()：设置或返回表单字段的值，即value属性的值</li>
</ul>
<p>获取属性的方法：</p>
<ul>
<li><p>attr(属性名称)：返回对应属性的值</p>
<p>例如获取超链接中href的值：$("#a").attr("href")，就是获取id为a的超链接元素的href属性对应的值</p></li>
</ul>
<h2 id="设置元素内容">设置元素内容</h2>
<p>同样适用上面三个获取内容的方法：text()，html()，val()。</p>
<ul>
<li><p>可以直接将希望设置的值传入该方法的参数，进行设置。</p></li>
<li><p>它们拥有回调函数，回调函数有两个参数：<strong>被选元素列表中当前元素的下标(因为每个JQuery对象都是数组，索引从0开始)，以及原始值</strong>(旧值)，然后使用return返回您希望使用的字符串，即函数新值。</p>
<p>例子：</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    $(<span class="string">&quot;#change&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        $(<span class="string">&quot;p&quot;</span>).<span class="title function_">text</span>(<span class="keyword">function</span> (<span class="params">i, oldText</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;索引值为:&quot;</span> + i + <span class="string">&quot;，旧文本为:&quot;</span> + oldText;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>将原来的段落内容改为打印对应索引并再次输出旧文本，结果为：</p>
<figure>
<img
src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/20200922181854.png"
alt="image-20200922181846914" />
<figcaption aria-hidden="true">image-20200922181846914</figcaption>
</figure></li>
</ul>
<h2 id="设置属性内容">设置属性内容</h2>
<p>上述的attr方法同样可以设置/改变属性值</p>
<ul>
<li><p>可以直接向attr方法传入指定值，例如：<code>$("button").click(function()&#123;
$("#baidu").attr("href",
"http://www.baidu.com")&#125;    )</code>，设置了id为baidu的超链接元素的href属性的值为百度的网站</p></li>
<li><p>attr方法也允许设置多个属性：</p>
<p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;button&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    $(<span class="string">&quot;#baidu&quot;</span>).<span class="title function_">attr</span>(&#123;</span><br><span class="line">        <span class="string">&quot;href&quot;</span> : <span class="string">&quot;http://www.baidu.com&quot;</span>,</span><br><span class="line">        <span class="string">&quot;title&quot;</span> : <span class="string">&quot;百度网址&quot;</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p></li>
</ul>
<p>attr()也提供回调函数，回调函数有两个参数：<strong>被选元素列表当前元素的下标，以及原始(旧)的值</strong>，新值用return返回</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;button&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  $(<span class="string">&quot;#runoob&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;href&quot;</span>, <span class="keyword">function</span>(<span class="params">i,origValue</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> origValue + <span class="string">&quot;/jquery&quot;</span>; </span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="添加元素">添加元素</h2>
<p>有四种添加新元素的JQuery方法</p>
<ul>
<li>append()：在被选元素结尾插入内容</li>
<li>prepend()：在被选元素开头插入内容</li>
<li>after()：在被选元素之后插入内容</li>
<li>before()：在被选元素之前插入内容</li>
</ul>
<h3 id="append方法">append()方法</h3>
<p>该方法在被选元素的结尾插入内容(仍然在该元素的内部)。</p>
<h3 id="prepend方法">prepend()方法</h3>
<p>该方法在被选元素的开头插入内容。</p>
<p>可以通过前两个方法添加若干个新元素，append和perpend方法可以通过参数接收无限数量的新元素。</p>
<p>例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">appendText</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> txt1=<span class="string">&quot;&lt;p&gt;文本-1。&lt;/p&gt;&quot;</span>;              <span class="comment">// 使用 HTML 标签创建文本</span></span><br><span class="line">    <span class="keyword">var</span> txt2=$(<span class="string">&quot;&lt;p&gt;&lt;/p&gt;&quot;</span>).<span class="title function_">text</span>(<span class="string">&quot;文本-2。&quot;</span>);  <span class="comment">// 使用 jQuery 创建文本</span></span><br><span class="line">    <span class="keyword">var</span> txt3=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;p&quot;</span>);</span><br><span class="line">    txt3.<span class="property">innerHTML</span>=<span class="string">&quot;文本-3。&quot;</span>;               <span class="comment">// 使用 DOM 创建文本 text with DOM</span></span><br><span class="line">    $(<span class="string">&quot;body&quot;</span>).<span class="title function_">append</span>(txt1,txt2,txt3);        <span class="comment">// 追加新元素</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="after方法和before方法">after()方法和before()方法</h3>
<p>after方法在被选元素之后插入内容。</p>
<p>before方法在被选元素之前插入新元素</p>
<h3
id="appendprepend和afterbefore的区别">append/prepend和after/before的区别</h3>
<p>用append:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;s1&quot;</span>&gt;</span>s1<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">&lt;/p&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">$(<span class="string">&quot;p&quot;</span>).<span class="title function_">append</span>(<span class="string">&#x27;&lt;span class=&quot;s2&quot;&gt;s2&lt;/span&gt;&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//结果是：</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;s1&quot;</span>&gt;</span>s1<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;s2&quot;</span>&gt;</span>s2<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>用after:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;s1&quot;</span>&gt;</span>s1<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">&lt;/p&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">$(<span class="string">&quot;p&quot;</span>).<span class="title function_">after</span>(<span class="string">&#x27;&lt;span class=&quot;s2&quot;&gt;s2&lt;/span&gt;&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//结果是这样的:</span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;s1&quot;</span>&gt;</span>s1<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;s2&quot;</span>&gt;</span>s2<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>总结：</p>
<ul>
<li>append/prepend是在被选择的元素内部嵌入</li>
<li>after/before是在元素外面追加</li>
</ul>
<h2 id="删除元素">删除元素</h2>
<p>可以使用以下两个JQuery方法来删除元素：</p>
<ul>
<li>remove：删除被选元素和子元素</li>
<li>empty：删除被选元素的子元素，也就是清空被选元素。</li>
</ul>
<p>remove方法也可以接受一个参数，允许对被删除的元素进行过滤，该参数可以是任何JQuery选择器的语法。</p>
<p>例如：删除class='inalic'的p元素</p>
<p>$("p").remove(".inalic")；</p>
<h2 id="获取并设置css类">获取并设置CSS类</h2>
<p>JQuery有很多对CSS操作的方法：</p>
<ul>
<li>addClass()：向被选元素添加一个或多个类</li>
<li>removeClass()：从被选元素删除一个或多个类</li>
<li>toggleClass()：对被选元素进行 添加/删除类的切换操作</li>
<li>css()：设置或 返回样式属性</li>
</ul>
<p>先在css文件中定义两个类：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.important</span> &#123;</span><br><span class="line">	<span class="attribute">color</span>:brown;</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">30px</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="selector-class">.unimportant</span> &#123;</span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">15px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在就有important和unimportant两个类了。</p>
<h3 id="addclass方法">addClass()方法</h3>
<p>该方法可以给多个元素添加多个css类，可以接受多个css类参数</p>
<p>例子：给h1和h2添加important类</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#button&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    $(<span class="string">&quot;h1,h2&quot;</span>).<span class="title function_">addClass</span>(<span class="string">&quot;important&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure>
<img
src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/20200926094734.gif"
alt="1" />
<figcaption aria-hidden="true">1</figcaption>
</figure>
<h3 id="removeclass方法">removeClass()方法</h3>
<p>删除指定的class属性。</p>
<p>例子：删除上述元素的important类属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#remove&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    $(<span class="string">&quot;h1, h2&quot;</span>).<span class="title function_">removeClass</span>(<span class="string">&quot;important&quot;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure>
<img
src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/20200926100652.gif"
alt="2" />
<figcaption aria-hidden="true">2</figcaption>
</figure>
<h3 id="toggleclass方法">toggleClass()方法</h3>
<p>该方法对被选元素进行添加/删除类的切换操作：</p>
<p>例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#button&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    $(<span class="string">&quot;h1,h2&quot;</span>).<span class="title function_">toggleClass</span>(<span class="string">&quot;important&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure>
<img
src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/20200926102152.gif"
alt="3" />
<figcaption aria-hidden="true">3</figcaption>
</figure>
<h3 id="css方法">css()方法</h3>
<p>css方法设置或者返回被选元素的一个或多个样式属性。</p>
<h4 id="返回css属性">返回CSS属性</h4>
<p>语法为： <code>css("propertyname");</code></p>
<p>例子：<code>$("p").css("background-color");</code></p>
<h4 id="设置css属性">设置CSS属性</h4>
<p>语法：<code>css("propertyname", "value");</code></p>
<p>例子：<code>$("p").css("background-color", "yellow");</code></p>
<h4 id="设置多个css属性">设置多个CSS属性</h4>
<p>语法：<code>css(&#123;"propertyname":"value",
"propertyname":"value",...&#125;);</code></p>
<p>例子：<code>$("p").css(&#123;"background-color":"yellow",
"font-size":"200%"&#125;)</code></p>
<h2 id="jquery尺寸方法">JQuery尺寸方法</h2>
<p>JQuery提供了很多处理尺寸的方法</p>
<ul>
<li>width()</li>
<li>height()</li>
<li>innerWidth()</li>
<li>innerHeight()</li>
<li>outerWidth()</li>
<li>outerHeight()</li>
</ul>
<h3 id="width和height方法">width和height方法</h3>
<p>width方法用来设置或者返回元素的宽度(不包括内边距，边框或外边距)</p>
<p>height方法用来设置或返回元素的高度(不包括内边距，边框或外边距)</p>
<p>例子：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 200px;height: 200px; padding: 10px; border: 5px;background-color:burlywood&quot;</span> <span class="attr">id</span>=<span class="string">&quot;div&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;显示尺寸&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>js代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    $(<span class="string">&quot;#button&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">       <span class="keyword">let</span> width = $(<span class="string">&quot;#div&quot;</span>).<span class="title function_">width</span>();</span><br><span class="line">       <span class="keyword">let</span> height = $(<span class="string">&quot;#div&quot;</span>).<span class="title function_">height</span>();</span><br><span class="line">       <span class="keyword">let</span> text = <span class="string">&quot;&lt;p&gt;该div元素的宽度为：&quot;</span> + width  + <span class="string">&quot;&lt;br&gt;该div元素的高度为：&quot;</span> + height + <span class="string">&quot;&lt;/p&gt;&quot;</span>;</span><br><span class="line">       $(<span class="string">&quot;#div&quot;</span>).<span class="title function_">html</span>(text);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure>
<img
src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/20200926103743.gif"
alt="4" />
<figcaption aria-hidden="true">4</figcaption>
</figure>
<h3 id="innerwidth和innerheight方法">innerWidth和innerHeight方法</h3>
<p>分别返回元素的高度和宽度(包括内边距)</p>
<h3 id="outerwidth和outerheight方法">outerWidth和outerHeight方法</h3>
<p>分别返回元素的宽度和高度(包括内边距和边框)</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/JavaWeb/JQuery/2-JQuery%E6%95%88%E6%9E%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/JavaWeb/JQuery/2-JQuery%E6%95%88%E6%9E%9C/" class="post-title-link" itemprop="url">2-JQuery效果</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 13:48:39 / 修改时间：16:55:00" itemprop="dateCreated datePublished" datetime="2022-05-11T13:48:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/javaweb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>JQuery有很多效果，例如隐藏，显示，切换，滑动，淡入淡出，以及动画等等。</p>
<h2 id="隐藏和显示">隐藏和显示</h2>
<p>隐藏和显示效果分别使用hide()和show()方法。</p>
<p>语法:</p>
<p>$(<em>selector</em>).hide(<em>speed,callback</em>);</p>
<p>$(<em>selector</em>).show(<em>speed,callback</em>);</p>
<p>上面两个参数都是可选的</p>
<p>speed参数规定隐藏/显示的速度，可以取以下值："slow"，"fast"或毫秒</p>
<p>callback参数是隐藏或者显示<strong>完成后执行</strong>的函数名称，也叫回调函数</p>
<p>使用toggle()方法可以来切换hide()和show()方法，如果元素已经隐藏，那么该方法会显示元素，反之亦然。该方法同样有两个可选参数。</p>
<h2 id="淡入淡出">淡入淡出</h2>
<p>淡入：fadeIn()</p>
<p>淡出：fadeOut()</p>
<p>切换淡入淡出：fadeToggle()</p>
<p>渐变为给定的不透明度：fadeTo()</p>
<h3 id="fadein方法">fadeIn()方法</h3>
<p>该方法用于淡入隐藏的元素。</p>
<p>语法：$(<em>selector</em>).fadeIn(<em>speed,callback</em>);</p>
<p>可选的参数speed规定效果时长，可取值与上述一致，不再重复</p>
<p>可选的参数callback参数是fading完成后执行的函数名称</p>
<h3 id="fadeout方法">fadeOut()方法</h3>
<p>该方法用于淡出可见的元素。</p>
<p>语法：$(<em>selector</em>).fadeOut(<em>speed,callback</em>);</p>
<p>可选的参数speed规定效果时长，可取值与上述一致，不再重复</p>
<p>可选的参数callback参数是fading完成后执行的函数名称</p>
<h3 id="fadetoggle方法">fadeToggle()方法</h3>
<p>该方法用于可以在fadeIn和fadeOut方法之间切换，如果元素已经淡出，那么该方法会添加淡入效果，反之亦然。</p>
<p>语法：$(<em>selector</em>).fadeToggle(<em>speed,callback</em>);</p>
<p>可选的参数speed规定效果时长，可取值与上述一致，不再重复</p>
<p>可选的参数callback参数是fading完成后执行的函数名称</p>
<h3 id="fadeto方法">fadeTo方法</h3>
<p>该iafangfayunxu渐变为给定的不透明度(值介于0与1之间)</p>
<p>语法：$(<em>selector</em>).fadeTo(<em>speed,opacity,callback</em>);</p>
<p><strong>必需的speed参数规定效果时长，可取值与上述一致，不再重复</strong></p>
<p>必需的opacity擦书将淡入淡出效果设置为给定的不透明度，0到1之间</p>
<p>可选的参数callback参数是fading完成后执行的函数名称</p>
<h2 id="滑动">滑动</h2>
<p>向下滑动：slideDown()</p>
<p>向上滑动：slideUp()</p>
<p>切换向上和向下滑动：slideToggle()</p>
<h3 id="slidedown方法">slideDown()方法</h3>
<p>该方法可向下滑动指定元素。</p>
<p>语法：$(selector).slideDown(speed, callback);</p>
<p>可选的参数speed规定效果时长，可取值与上述一致，不再重复</p>
<p>可选的参数callback参数是滑动完成后执行的函数名称</p>
<h3 id="slideup方法">slideUp()方法</h3>
<p>该方法可向上滑动指定元素。</p>
<p>语法：$(selector).slideUp(speed, callback);</p>
<p>可选的参数speed规定效果时长，可取值与上述一致，不再重复</p>
<p>可选的参数callback参数是滑动完成后执行的函数名称</p>
<h3 id="slidetoggle方法">slideToggle()方法</h3>
<p>该方法可以在slideDown和slideUp方法中进行切换，如果元素已经向下滑动了，那么slideTogge会向上滑动，反之亦然。</p>
<p>语法：$(selector).slideUp(speed, callback);</p>
<p>可选的参数speed规定效果时长，可取值与上述一致，不再重复</p>
<p>可选的参数callback参数是滑动完成后执行的函数名称</p>
<h2 id="动画">动画</h2>
<p>JQuery的animate()方法允许创建自定义动画</p>
<p>语法：$(<em>selector</em>).animate({<em>params</em>}<em>,speed,callback</em>);</p>
<p><strong>必需的params参数定义形成动画的CSS属性</strong></p>
<p>可选的参数speed规定效果时长，可取值与上述一致，不再重复</p>
<p>可选的参数callback参数是动画完成后执行的函数名称</p>
<p>实例1：将div元素向右移动250个像素</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;button&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    $(<span class="string">&quot;div&quot;</span>).<span class="title function_">animate</span>(&#123;<span class="attr">left</span>:<span class="string">&#x27;250px&#x27;</span>&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>实例2：操作多个属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;button&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  $(<span class="string">&quot;div&quot;</span>).<span class="title function_">animate</span>(&#123;</span><br><span class="line">    <span class="attr">left</span>:<span class="string">&#x27;250px&#x27;</span>,<span class="comment">//将元素向右挪动250个像素</span></span><br><span class="line">    <span class="attr">opacity</span>:<span class="string">&#x27;0.5&#x27;</span>,<span class="comment">//不透明度变为0.5</span></span><br><span class="line">    <span class="attr">height</span>:<span class="string">&#x27;150px&#x27;</span>,/高度为150px</span><br><span class="line">    <span class="attr">width</span>:<span class="string">&#x27;150px&#x27;</span><span class="comment">//宽度为150px</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>实例3：使用相对值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;button&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  $(<span class="string">&quot;div&quot;</span>).<span class="title function_">animate</span>(&#123;</span><br><span class="line">    <span class="attr">left</span>:<span class="string">&#x27;250px&#x27;</span>,<span class="comment">//向右挪动250px，使用绝对值</span></span><br><span class="line">    <span class="attr">height</span>:<span class="string">&#x27;+=150px&#x27;</span>,<span class="comment">//以当前高度为基准，再增加高度150px</span></span><br><span class="line">    <span class="attr">width</span>:<span class="string">&#x27;+=150px&#x27;</span><span class="comment">//以当前宽度为基准，再增加宽度150px</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>实例4：使用预定义的值</p>
<p>可以把属性的动画中设置为show，hide或者toggle</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;button&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  $(<span class="string">&quot;div&quot;</span>).<span class="title function_">animate</span>(&#123;</span><br><span class="line">    <span class="attr">height</span>:<span class="string">&#x27;toggle&#x27;</span><span class="comment">//toggle是预定义的值，在这里意思是如果显示了该div元素，就隐藏如果隐藏了，那么就显示</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>实例5：使用队列功能</p>
<p>JQuery提供针对动画的队列功能，意思是如果编写多个animate调用，那么JQuery会创建这些方法调用的内部队列，然后逐一运行这些调用。</p>
<p><strong>注意：animate方法几乎可以操作任何CSS属性，但是，当使用animate时，必须用Camel标记法书写所有属性名，就是有"-"的要去掉，例如padding-left要写成paddingLeft,margin-right要写成marginLeft；并且，色彩动画不包含在核心JQuery库中，要使用，需要下早颜色动画插件。</strong></p>
<h2 id="停止动画">停止动画</h2>
<p>stop方法用来停止动画或者效果，在它们完成之前。stop方法适用所有JQuery效果函数包括滑动，淡入淡出和自定义动画。</p>
<p>语法：$(<em>selector</em>).stop(<em>stopAll,goToEnd</em>);</p>
<p>可选的stopAll采纳数规定是否应该清除动画队列，默认为false：即停止活动的动画，允许任何排入队列的动画向后执行</p>
<p>可选的goToEnd参数规定是否立即完成当前动画，默认为false</p>
<h2 id="回调函数">回调函数</h2>
<p>许多JQuery函数有回调函数参数，包括动画函数。</p>
<p>回调函数在当前动画完成后执行。</p>
<p>例子：</p>
<p>有回调函数：警告框会在隐藏后显示</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;button&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  $(<span class="string">&quot;p&quot;</span>).<span class="title function_">hide</span>(<span class="string">&quot;slow&quot;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;段落现在被隐藏了&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>无回调函数：警告框会在隐藏效果完成前弹出</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;button&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  $(<span class="string">&quot;p&quot;</span>).<span class="title function_">hide</span>(<span class="number">1000</span>);</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&quot;段落现在被隐藏了&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>##　Chaining(链)</p>
<p>链允许在一条语句中运行多个JQuery方法(在相同的元素上)。</p>
<p>语法是在一个方法后直接再使用 "."来链接下一个方法。</p>
<p>例如把slideDown方法和slideUp方法链接到一起：<code>$("#p1").slideUp().slideDown();</code></p>
<p>可以添加很多个方法调用，语句很长时，可以使用换行缩进，JQuery会抛掉多余空格。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/JavaWeb/JQuery/1-JQuery%E4%BB%8B%E7%BB%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/JavaWeb/JQuery/1-JQuery%E4%BB%8B%E7%BB%8D/" class="post-title-link" itemprop="url">1-JQuery介绍</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 13:47:39 / 修改时间：16:54:58" itemprop="dateCreated datePublished" datetime="2022-05-11T13:47:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/javaweb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>JQuery是js的一个工具库，封装了js代码。简化了开发流程。</p>
<p>##　JQuery的基本语法</p>
<p>JQuery语法是通过选取HTML元素来执行一些操作。</p>
<p>基础语法：$(selector).action()</p>
<p>使用美元符号
“$”来进行选取，选择符selector查询和查找HTML元素，action执行对元素的操作</p>
<p>选择器和CSS差不多，有这么几种</p>
<ul>
<li>标签元素选择器：使用标签名称来获取元素数组，例如 $("p")
，表示获取所有
<p></li>
<li>id选择器：使用唯一的id来选取指定元素，例如
$("#test")，表示获取id为test的元素，<strong>注意 "#"</strong></li>
<li>.class选择器：使用类选择器来选取元素，例如
$(".test")，获取所有class为test的元素，<strong>注意"."</strong></li>
<li>括号中可以直接填DOM对象，例如 <code>var Obj =
document.getElementById("test");$(Obj).hide()</code></li>
</ul>
<p>除此之外，还可以通过属性来选取，</p>
<p>$("[attr]")：表示获取所有 有attr属性的元素</p>
<p>更多实例：</p>
<ul>
<li>$("*")：选取所有元素</li>
<li>$("this")：选取当前元素</li>
<li>$("p.intro")：选择class为intro的p元素</li>
<li>$("p:first")：选择第一个p元素</li>
<li>$("[href]")：选取带有href属性的元素</li>
<li>$("a[target='_blank']")：选取所有target属性值为"_blank"的<a>元素</li>
<li>$("a[target!='_blank']")：选取所有target属性值不为"_blank"的<a>元素</li>
<li>$(":button")：选取所有type="button"的<input>元素和<button>元素</li>
</ul>
<h2 id="dom对象和jquery对象">DOM对象和JQuery对象</h2>
<p>使用js语法创建的对象就是DOM对象，使用JQuery语法创建的对象叫做JQuery对象。<strong>注意：JQuery表示的对象都是数组。即使某些数组只有一个元素。</strong></p>
<p>DOM对象和JQuery对象可以互相转换：</p>
<p>DOM对象转为JQuery对象：语法，$(DOM对象)</p>
<p>JQuery对象转为DOM对象：语法，从数组中获取第一个对象，第一个对象就是DOM对象，使用[0]或者get[0]</p>
<p>转换是为了使用指定对象的属性和方法。</p>
<h2 id="入口函数的几种写法">入口函数的几种写法</h2>
<p>在js中，要将js代码写在<code>window.onload() =
function()&#123;&#125;</code>中，类似的，在JQuery中，也有几种写法。</p>
<ul>
<li>使用<code>$(document).ready(function()&#123;&#125;)</code>，将代码写到function函数中，用$符号将document转换为JQuery对象，使用该对象的ready方法，类似window.onload</li>
<li>是上面的简洁写法，即<code>$(function()&#123;&#125;)</code>，一般使用这种多一些</li>
</ul>
<p>除此之外，<code>jQuery(function()&#123;&#125;)</code>和<code>window.jQuery(function(&#123;&#125;))</code>也是等价的。</p>
<h3
id="jquery入口函数和javascript入口函数的区别">jQuery入口函数和JavaScript入口函数的区别</h3>
<ul>
<li>jQuery的入口函数是在html所有标签都加载之后，就会去执行，可以执行多次，不会被覆盖</li>
<li>JavaScript的window.onload时间是等到所有内容，包括外部图片之外的文件夹在完后，才会去执行，只能执行一次，如果执行第二次，第一次的执行会被覆盖</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/JavaWeb/Servlet/12-%E8%BF%87%E6%BB%A4%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/JavaWeb/Servlet/12-%E8%BF%87%E6%BB%A4%E5%99%A8/" class="post-title-link" itemprop="url">11-过滤器</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 13:45:39 / 修改时间：16:55:51" itemprop="dateCreated datePublished" datetime="2022-05-11T13:45:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/javaweb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>##　介绍</p>
<p>首先来看，过滤器在整个Ｗｅｂ流程的哪里：</p>
<figure>
<img
src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/20200815085902.png"
alt="image-20200815085855245" />
<figcaption aria-hidden="true">image-20200815085855245</figcaption>
</figure>
<p>从上面的图，我们可以看出来，当浏览器发送请求给服务器时，会先执行过滤器，再访问Web资源；服务器响应Response时，也会先执行过滤器，再发送请求资源给浏览器。</p>
<h3 id="作用">作用</h3>
<ul>
<li>拦截Http服务器，帮助Http服务器检测当前请求合法性</li>
<li>拦截Http服务器，对当前请求进行增强操作</li>
</ul>
<p>例如，在没有过滤器时，如果要处理中文乱码情况，需要在每个Sevlet中都设定编码，但是这样，代码重复率很高；有了过滤器，情况就不一样了，只要在过滤器中指定了编码，那么就可以使全站的Web资源都是使用该编码。</p>
<p>当然，过滤器的作用很多，还可以过滤一些敏感的字符串，权限验证(规定只有带Session或Cookie的浏览器才能访问web资源)等等。</p>
<h3 id="filter接口过滤器接口">Filter接口(过滤器接口)</h3>
<ul>
<li>来自于Sevlet规范下接口</li>
<li>Filter接口实现类由开发人员提供，Http服务器不提供实现</li>
</ul>
<h4 id="filter接口开发类步骤">Filter接口开发类步骤</h4>
<ul>
<li>创建一个Java类实现Filter接口</li>
<li>重写Filter接口中的doFilter方法</li>
<li>在web.xml文件中将过滤器接口实现类注册到Http服务器</li>
</ul>
<h2 id="filter接口-api">Filter接口 API</h2>
<p>Filter接口有三个方法</p>
<ul>
<li>void init(FilterConfig filterconfig)</li>
<li>void destroy()</li>
<li>void doFilter(ServletRequest servletRequest, ServletResponse
servletResponse, FilterChain filterChain)</li>
</ul>
<p>前两个方法很好理解，它们只在Web服务器加载和销毁时被执行，且只会被执行一次。</p>
<p>比较重要的是doFilter方法：有三个参数，前面两个参数和doGet，doPost方法参数一样，请求参数和响应参数，ServletRequest是HttpServletRequest的父接口。</p>
<p>第三个参数FilterChain类型，也是一个接口，该接口只有一个方法：doFilter(ServletRequest
var1, ServletResponse var2)。</p>
<p>感觉有点糊涂了，怎么有一个doFilter方法。</p>
<p>可以这样理解：过滤器不止一个，那么就需要管理这些过滤器，在Java中使用了链式结构，把所有的过滤器都放在了FilterChain中，如果符合条件，就执行下一个过滤器，一直到没有符合条件的过滤器，就执行目标资源。</p>
<p>简单来说，FilterChain掌管着所有过滤器，执行完一个，由FilterChain去判断是否还有符合条件的下一个过滤器，如果有，继续执行下一个过滤器，没有，就执行目标资源。</p>
<h2 id="一个简单的例子">一个简单的例子</h2>
<p>首先写一个简单的过滤器：设置当浏览器访问timg.jpg图片资源时，如果年龄小于等于40，就可以访问，大于40，就不能访问，并输出提示信息。</p>
<p>WebFilter代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获得年龄参数</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">age</span> <span class="operator">=</span> servletRequest.getParameter(<span class="string">&quot;age&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(Integer.valueOf(age) &lt;= <span class="number">40</span>) &#123;</span><br><span class="line">            filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//如果年龄大于40，就输出提示信息，没执行filterChain.doFilter方法，就会直接返回给浏览器</span></span><br><span class="line">            servletResponse.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">            <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> servletResponse.getWriter();</span><br><span class="line">            out.print(<span class="string">&quot;&lt;h1&gt;你不能查看此资源!&lt;h1&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后需要在web.xml文件中进行注册：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>webFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>filter.WebFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>webFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/timg.jpg<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这个例子中，希望过滤器当浏览器访问timg.jpg文件时，进行拦截。</p>
<p><strong>filter标签中有：</strong></p>
<ul>
<li><p><strong>filter-name：用于为过滤器设置一个名字</strong></p></li>
<li><p><strong>filter-class：是过滤器实现类的完整限定类名</strong></p></li>
<li><p><strong>init-param：该元素用于为过滤器指定初始化参数，它的子元素param-name指定参数名字，param-value指定参数的值，在过滤器中可以使用FilterConfig接口对象来访问初始化参数</strong></p></li>
</ul>
<p><strong>filter-mapping：是用来设置当浏览器访问哪些资源时，哪个过滤器需要进行拦截</strong></p>
<p><strong>可以有两种方式来指定：Sevlet名称，资源访问的请求路径</strong></p>
<p><strong>filter-mapping标签中有：</strong></p>
<ul>
<li><strong>filter-name：写上需要使用的过滤器名字，该值必须是在filter中声明过的</strong></li>
<li><strong>url-pattern：设置filter所拦截的请求路径</strong></li>
<li><strong>servlet-name：指定过滤器所拦截的Servlet名称</strong></li>
<li><strong>dispatcher：指定当用户以什么样的方式访问资源时，过滤器需要拦截，有四个可取值：REQUEST,INCLUDE,FORWORD,ERROR，
默认为REQUEST，用户可以设置多个<dispatcher>标签子元素来指定Filter对资源的多种调用方式进行拦截。</strong>
<ul>
<li>REQUEST：当用户直接访问页面时，Web容器将会调用此过滤器。如果目标资源是通过RequestDispatcher的include()或forword方法访问时，那么该过滤器就不会被调用</li>
<li>INCLUDE:如果目标资源是通过RequestDispatcher的include方法访问时，那么该过滤器将被调用，除此之外，该过滤器不会被调用</li>
<li>FORWORD：如果该目标资源是通过RequestDispatcher的forword方法访问时，那么该过滤器将被调用，除此之外，该过滤器不会被调用。</li>
<li>ERROR：如果目标资源使用过声明式异常处理机制被调用时，那么该过滤器将被调用，除此之外，过滤器不会被调用</li>
</ul></li>
</ul>
<h2 id="过滤器的执行顺序">过滤器的执行顺序</h2>
<p>首先看一个测试:</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;准备放行&quot;</span>);</span><br><span class="line"></span><br><span class="line">    filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;放行成功&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>执行结果为：</p>
<figure>
<img
src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/20200815143154.png"
alt="image-20200815143152988" />
<figcaption aria-hidden="true">image-20200815143152988</figcaption>
</figure>
<p>完整的执行流程为：客户端发送请求给Http服务器，服务器执行过滤器，先打印"准备放行"，接着执行doFilter方法，服务器发现没有其他过滤器，就执行目标资源，执行完以后，再回到过滤器，继续执行代码，打印"放行成功"。</p>
<p>再看一个测试：</p>
<p>有两个过滤器：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Filter1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Filter1</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;开始执行Filter1&quot;</span>);</span><br><span class="line"></span><br><span class="line">        filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Filter1执行结束&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Filter2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Filter2</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;开始执行Filter2&quot;</span>);</span><br><span class="line"></span><br><span class="line">        filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Filter2执行结束&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试的Servlet的doGet方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;执行Servlet代码&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果为：</p>
<figure>
<img
src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/20200815144016.png"
alt="image-20200815144016042" />
<figcaption aria-hidden="true">image-20200815144016042</figcaption>
</figure>
<p>由该执行结果可知，执行顺序为：先执行Filter1，然后执行Filter1的doFilter方法，就转到下一个过滤器Filter2，等Filter2执行完后，再回到Filter1继续执行。</p>
<p><strong>其中，过滤器之间的执行顺序是看在web.xml文件中mapping的先后顺序的，放在前面的先执行。</strong></p>
<h2 id="filter的简单应用">Filter的简单应用</h2>
<p>filter有三种典型应用：</p>
<ul>
<li>可以在filter中根据条件来决定是否调用filterChain.doFilter()方法，即是否让目标资源继续执行</li>
<li>在让目标资源执行之前，可以对request，再让目标资源执行</li>
<li>在目标资源执行之后，可以捕获目标资源执行结果，从而实现一些特殊功能</li>
</ul>
<h2 id="过滤器拦截地址-url-pattern-格式">过滤器拦截地址 url-pattern
格式</h2>
<p>在web.xml文件中，以下语法用来定义映射：</p>
<ul>
<li>以 "/" 和 “/*” 结尾的是用来做路径映射</li>
<li>以前缀 “*.” 开头的是用来做 拓展映射</li>
<li>“/” 是用来定义default servlet映射的</li>
<li>剩下的都是用来定义详细映射的，比如：/aa/bb/cc.jpg</li>
</ul>
<p>有几种情况：</p>
<ul>
<li>在调用某一具体文件时，拦截格式：<url-pattern>/img/test.jpg</url-pattern></li>
<li>在调用某一文件下的资源文件时，拦截格式：<url-pattern>/img/*</url-pattern></li>
<li>在调用任意文件夹下某种类型文件时，拦截格式：<url-pattern>*.jpg</url-pattern><!--注意，没有 “/”--></li>
<li>在调用网站任意文件时，拦截格式：<url-pattern>/*</url-pattern></li>
</ul>
<p>**注意：定义例如
“/*.action”是错误的，因为这既属于路径映射，又属于拓展映射，服务器无法分辨**</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/JavaWeb/Servlet/11-%E7%9B%91%E5%90%AC%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/JavaWeb/Servlet/11-%E7%9B%91%E5%90%AC%E5%99%A8/" class="post-title-link" itemprop="url">10-监听器</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 13:44:39 / 修改时间：16:55:44" itemprop="dateCreated datePublished" datetime="2022-05-11T13:44:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/javaweb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>#　介绍</p>
<p>监听器设计三个组件：事件源，事件对象，事件监听器</p>
<p>三者关系为：事件监听器监听事件源的方法，当触发事件源的事件时，事件监听器就调用对应的方法，同时将该事件对象作为参数传递给该方法。</p>
<p>事件源可以通过事件对象获得。</p>
<p>事件源需要注册监听器对象（简单来说，就是告诉监听器你要监听哪个事件源）。</p>
<h2 id="servlet监听器">Servlet监听器</h2>
<h3 id="介绍">介绍</h3>
<ul>
<li>它们是一组来自Servlet规范下的接口，共有8个</li>
<li>Http服务器没有提供实现类，需要开发人员手动实现</li>
<li>监听器接口用于监控作用域对象生命周期变化时刻和作用域对象共享数据变化时刻</li>
</ul>
<p>在Servlet规范中定义了多种类型监听器，他们用于监听的事件源分别为：</p>
<ul>
<li>ServletContext：全局作用域对象</li>
<li>HttpSession：会话作用域对象</li>
<li>ServletRequest：请求作用域对象</li>
</ul>
<p>对应的监听器对象分别为ServletContextListener，HttpSessionListener和ServletRequestListener。</p>
<p>不过和其他事件监听器不同的是，Servlet监听器的注册不是直接注册在事件源上，而是由WEB容器负责注册，开发人员需要在web.xml文件中使用<listener>标签配置好监听器。</p>
<h3 id="监听类接口实现类开发规范">监听类接口实现类开发规范</h3>
<p>共分三步：</p>
<ul>
<li>根据监听实际情况，选择对应监听器接口进行实现</li>
<li>重写监听器接口声明(即监听事件处理方法)</li>
<li>在web.xml文件中将监听器接口实现类注册到Http服务器</li>
</ul>
<h2 id="监听器监听对象的创建和销毁">监听器监听对象的创建和销毁</h2>
<p>HttpSessionListener、ServletContextListener、ServletRequestListener分别监控着Session、
Context、Request对象的创建和销毁。</p>
<p>每个接口都定义了两个方法，分为为对象创建和销毁的方法</p>
<figure>
<img
src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/20200814092651.png"
alt="20200813204102" />
<figcaption aria-hidden="true">20200813204102</figcaption>
</figure>
<p>监听器可以监听到ServletContext的初始化和销毁，Session的创建。(服务器关闭，不代表Session被销毁，Session创建在服务器内存中，所以看不到Session被销毁)</p>
<h2 id="监听对象属性变化">监听对象属性变化</h2>
<p>ServletContextAttributeListener、HttpSessionAttributeListener、ServletRequestAttributeListener
分别监听着Context、Session、Request对象属性的变化。</p>
<p>三个接口都定义了三个方法来处理被监听对象中的属性增加，删除和替换的事件，同一个事件在这三个接口中对应方法名称完全相同，只是接受参数类型不同。</p>
<figure>
<img
src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/20200814111221.png"
alt="image-20200814111213577" />
<figcaption aria-hidden="true">image-20200814111213577</figcaption>
</figure>
<p>只演示Context对象，其他都可依此类推。</p>
<p>监听器对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Listener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextAttributeListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Listener</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attributeAdded</span><span class="params">(ServletContextAttributeEvent scae)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Ｃｏｎｔｅｘｔ对象增加了属性&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attributeRemoved</span><span class="params">(ServletContextAttributeEvent scae)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Ｃｏｎｔｅｘｔ对象删除了属性&quot;</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attributeReplaced</span><span class="params">(ServletContextAttributeEvent scae)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Ｃｏｎｔｅｘｔ对象更新了属性&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>用于测试Servlet对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> request.getServletContext();</span><br><span class="line">        servletContext.setAttribute(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;哈哈哈ce&quot;</span>);</span><br><span class="line">        servletContext.setAttribute(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;哈哈哈哈&quot;</span>);</span><br><span class="line">        servletContext.removeAttribute(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试结果为：</p>
<figure>
<img
src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/20200814112021.png"
alt="image-20200814112021198" />
<figcaption aria-hidden="true">image-20200814112021198</figcaption>
</figure>
<h2 id="监听session内的对象">监听Session内的对象</h2>
<p>除了上述六种Listener，还有两种Listener监听Session内的对象，分别是HttpSessionBindingListener和HttpSessionActivationListener，实现这两个接口不需要在web.xml文件中注册。</p>
<ul>
<li>实现HttpSessionBindingListener接口，JavaBean对象可以感知自己被绑定到Session中和从Session中删除的事件(和HttpSessionAttributeListener的作用差不多)</li>
<li>实现HttpSessionActivationListener接口，JavaBean对象可以感知自己被活化和钝化的事件(当服务器关闭的时候，会将Session的内容保存在硬盘上，称为钝化；服务器开启时，会将Session的内容在硬盘上重新加载，称为活化)</li>
</ul>
<figure>
<img
src="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/20200814141343.png"
alt="image-20200814141343471" />
<figcaption aria-hidden="true">image-20200814141343471</figcaption>
</figure>
<p>如果想要测试Session的硬化和钝化，需要修改Tomcat配置。在META-INF目录下的context.xml文件中添加代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Manager</span> <span class="attr">className</span>=<span class="string">&quot;org.apache.catalina.session.PersistentManager&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">maxIdleSwap</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Store</span> <span class="attr">className</span>=<span class="string">&quot;org.apache.catalina.session.FileStore&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">directory</span>=<span class="string">&quot;zhongfucheng&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Manager</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="监听器的简单应用">监听器的简单应用</h2>
<h3 id="加快程序运行速度">加快程序运行速度</h3>
<p>例如在之前做的在线考试管理系统中，用户注册需要连接数据库，插入数据，其中Connection的创建和销毁非常消耗时间，所以需要在服务器启动时就创建一批Connection，即数据库连接池，那么程序如何知道Tomcat服务器什么时候启动呢，就可以使用全局作用域对象ServletContext对象的监听器，其中的初始化方法，服务器在启动时，一定会创建ServletContext对象，就可以编写监听器对象方法，在这个方法中，创建一批Connection对象，即可加快程序运行速度</p>
<h3 id="统计网站在线人数">统计网站在线人数</h3>
<p>在网站中使用Session来标识用户是否登录，如果登录了，就在Session域中保存相应属性，如果没有登录，那么Session属性就为空。</p>
<p>要统计网站在线人数，应该这样做：监听是否有新的Session创建了，如果有，那么在线人数就+1，这个在线人数是针对整个网站的，所以需要使用Context全局作用域对象来保存</p>
<p>所以思路就是：</p>
<ul>
<li>监听Session是否被创建，如果被创建了，那么在Context的域对象的值就加1</li>
<li>如果Session从内存中被移除了，那么在Context的域对象中的值-1</li>
</ul>
<p>监听器代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Listener</span> <span class="keyword">implements</span> <span class="title class_">HttpSessionListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Listener</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sessionCreated</span><span class="params">(HttpSessionEvent se)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> se.getSession().getServletContext();</span><br><span class="line"></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">num</span> <span class="operator">=</span> (Integer) servletContext.getAttribute(<span class="string">&quot;num&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(num == <span class="literal">null</span>) &#123;</span><br><span class="line">            servletContext.setAttribute(<span class="string">&quot;num&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            num++;</span><br><span class="line">            servletContext.setAttribute(<span class="string">&quot;num&quot;</span>, num);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sessionDestroyed</span><span class="params">(HttpSessionEvent se)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> se.getSession().getServletContext();</span><br><span class="line"></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">num</span> <span class="operator">=</span> (Integer) servletContext.getAttribute(<span class="string">&quot;num&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(num == <span class="literal">null</span>) &#123;</span><br><span class="line">            servletContext.setAttribute(<span class="string">&quot;num&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            num--;</span><br><span class="line">            servletContext.setAttribute(<span class="string">&quot;num&quot;</span>, num);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/JavaWeb/Servlet/10-Session/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/JavaWeb/Servlet/10-Session/" class="post-title-link" itemprop="url">9-Session</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 13:43:39 / 修改时间：16:55:42" itemprop="dateCreated datePublished" datetime="2022-05-11T13:43:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/javaweb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="什么是session">什么是Session</h2>
<p>Session是另外一种记录浏览器状态的机制，不同的是Cookie保存在浏览器中，Session保存在服务器中。用户使用浏览器访问服务器时，服务器会把用户的信息以某种形式记录在服务器中。</p>
<p>如果把Cookie比做
检查用户带来的通行证来确认用户身份，那么Session就是通过检查服务器上的“客户信息表”来确认用户身份信息，Session相当于在服务器中建立了一份“客户明细表”。</p>
<h2 id="为什么使用session技术">为什么使用Session技术</h2>
<p>Session比Cookie使用方便，Session可以解决Cookie解决不了的事，适用范围更广，例如Session可以存储对象，但是Cookie只能存储字符串。</p>
<h2 id="seesion-api">Seesion API</h2>
<ul>
<li>long getCreationTime()：获取Seesion被创建的时间</li>
<li><strong>String getId()：获取Session的id</strong></li>
<li>long getLastAccessedTime()：返回Session最后活跃的时间</li>
<li>ServletContext getServletContext()：获取ServletContext对象</li>
<li><strong>void setMaxInactiveInterval(int
var1)：设置Session超时时间</strong></li>
<li><strong>int
getMaxInactiveInterval()：获取Session超时时间</strong></li>
<li><strong>Object getAttribute(String
var1)：获取Session属性</strong></li>
<li>Eumeration getAttributeName()：获取Session所有的属性名</li>
<li><strong>void setAttribute(String var1, Object
var2)：设置Session属性</strong></li>
<li><strong>void removeAttribute(String
var1)：移除Session属性</strong></li>
<li><strong>void invalidate()：销毁该Session</strong></li>
<li>boolean isNew()：该Session是否为新的</li>
</ul>
<h2 id="httpsession接口">HttpSession接口</h2>
<h3 id="介绍">介绍</h3>
<ul>
<li>HttpSession接口来自于Servlet规范下的一个接口，实现类由Http服务器提供</li>
<li>如果两个Servlet来自于同一个网站，并且为同一个浏览器/用户提供服务，那么此时可以通过HttpSession对象进行数据共享</li>
<li>习惯上将HttpSession接口修饰对象称为ie会话作用域对象</li>
</ul>
<p>可以看出，Session有着和request和ServletContext类似的方法，Session作为一种记录浏览器状态的机制，只要Session没有被销毁，Servlet之间就可以直接通过Session对象实现通讯。</p>
<p>简单例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Servlet1代码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//得到Session对象</span></span><br><span class="line"><span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line"><span class="comment">//设置Session属性</span></span><br><span class="line">session.setAttribute(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;哈哈哈哈哈哈&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Servlet2代码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//获取从Servlet1的Session存进去的值</span></span><br><span class="line"><span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line"><span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> (String) session.getAttribute(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">System.out.println(value);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>一般来讲，当我们要存进去的是用户级别的数据就用Session，用户级别就是：只要浏览器不关闭，希望数据还在，就是用Seesion保存。</p>
<h2 id="session的实现原理">Session的实现原理</h2>
<p><strong>当浏览器访问某个网页时，会在服务器端内存开辟一块内存，这块内存就叫做Session，，这个内存是和浏览器关联在一起的，这个浏览器指的是浏览器窗口，或者是浏览器的子窗口，意思是：只允许当前这个session对应的浏览器访问，就算再在同一个机器上启动新的一个浏览器也是无法访问的，而另外一个浏览器也需要记录Session的话，服务器就会再创建一个属于这个浏览器的session。</strong></p>
<p><strong>简单来说，一个客户端的一个处于打开状态的浏览器对应一个Session。</strong></p>
<p><strong>需要注意的是，例如，谷歌浏览器访问一个网站，在不关闭前一个浏览器的情况下，再打开一个谷歌浏览器窗口打开同一个网站，访问的是一个Session。但是如果关闭了前一个浏览器，再打开该浏览器打开该网站，那么就会创建新的Session。</strong></p>
<p>但是，如果按照上述代码，在浏览器新建一个会话，先访问Servlet2，那么会出现空指针异常。</p>
<p>那么问题来了：服务器是如何实现一个session为一个用户浏览器服务的呢？换个说法：为什么服务器能够为不同用户浏览器提供不同session？</p>
<p><strong>Http协议是无状态的，Session不能依据HTTP连接来判断是否为同一个用户，于是：服务器向用户发送了一个名为JESSIONID的Cookie，它的值是Session的id值，Session依据这个Cooie来识别是否为同一个用户。</strong></p>
<p><strong>简单来说，Session之所以可以识别不同用户，依靠的就是Cookie。该Cookie是服务器自动颁发给浏览器的，不需要手动创建，该Cookie的maxAge默认值为-1，也就是说仅供当前浏览器使用，不会将该Cookie存在硬盘中。</strong></p>
<p>捋一下思路流程：当访问Servlet1时，服务器会创建一个Session对象，执行程序代码，并且自动颁发给Cookie给用户浏览器。</p>
<p>当使用同一个浏览器访问Servlet2时，浏览器会把Cookie发给服务器，服务器通过Cookie存储的Session的ID就知道该浏览器使用的是哪个Session。</p>
<p>但是当使用新会话浏览器直接访问Servlet2时，该新浏览器没有Cookie，所有服务器无法辨认使用哪个浏览器，所以就获取不到值，所以前面例子出现空指针异常。</p>
<h3 id="url地址重写">URL地址重写</h3>
<p>前面提到，Session是通过Cookie来识别浏览器，但是如果用户浏览器禁用了Cookie（<strong>注意，禁用Cookie意味着浏览器不能向服务器发送Cookie，但是浏览器还是可以接受Cookie，也就是响应头可以有Cookie，但是请求头不能有</strong>），那么应该怎么办，JavaWeb提供了另一种方式：URL地址重写</p>
<p>HttpServletResponse类提供了两个URL地址重写的方法：</p>
<ul>
<li>encodingURL(String url)</li>
<li>encodingRedirectURL(String url)</li>
</ul>
<p>这两个方法会自动判断该浏览器是否支持Cookie，如果支持Cookie，重写后的URL地址就不会带有jsessionid了（当然，即使浏览器支持Cookie，第一次输出URL地址时还是会出现jsessionid，因为没有任何Cookie可带）。</p>
<p>使用Session，改写一下Cookie文档商品例子里的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//之前的代码，超链接直接为对应的链接</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(Map.Entry&lt;String, Book&gt; bookEntry : entries) &#123;</span><br><span class="line">            <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> bookEntry.getValue();</span><br><span class="line">            out.print(<span class="string">&quot;&lt;li&gt;&lt;a href=&#x27;/myweb/one?id=&quot;</span>+ book.getId() + <span class="string">&quot;&#x27; target=&#x27;_blank&#x27;&gt;&quot;</span> + book.getName() + <span class="string">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//修改后的代码,将链接使用encodingURL进行编码，然后再进行链接</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(Map.Entry&lt;String, Book&gt; bookEntry : entries) &#123;</span><br><span class="line">            <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> bookEntry.getValue();</span><br><span class="line">            <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> response.encodeURL(<span class="string">&quot;/myweb/one?id=&quot;</span> + book.getId());</span><br><span class="line">            out.print(<span class="string">&quot;&lt;li&gt;&lt;a href=&#x27;&quot;</span>+ url + <span class="string">&quot;&#x27; target=&#x27;_self&#x27;&gt;&quot;</span> + book.getName() + <span class="string">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>URL地址重写的原理为：将Session的id重写到URL地址中，服务器通过解析后重写URL，获取Session的id，这样一来，即使浏览器禁用了Cookie，但是Session的id还是可以通过服务器端传递。</p>
<h2 id="session的生命周期和有效期">Session的生命周期和有效期</h2>
<p>Session在用户第一次访问服务端Servlet，jsp等动态资源时就会自动创建，Session对象保存在内存中。</p>
<p>Session生成后，只要用户继续访问，服务器就会更新Session的最后访问时间，无论是否对Session进行读写，服务器都会认为Session活跃了一次。</p>
<p>由于随着越来越多用户访问服务器，因此Session也越来越多，为了防止内存溢出，服务器会把长时间没有活跃的Session从内存中删除，这个时间就是Session的超时时间。</p>
<p>Session默认超时时间为30分钟，有三种方式可以对Session的超时时间进行修改：</p>
<ol type="1">
<li><p>在tomcat/conf/web.xml文件中设置，对所有的WEB应用都有效</p>
<p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>20<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span><span class="comment">&lt;!--修改超时时间为20分钟--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>在单个web.xml文件中设置，只对单个web应用有效，如果冲突，以自己的web与你管用为准，代码和第一种一样。</p></li>
<li><p>通过setMaxInactiveInterval()方式设置</p>
<p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置最长超时时间为60秒，这个方法参数为秒</span></span><br><span class="line">session.setMaxInactiveInterval(<span class="number">60</span>);</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h2 id="session的简单应用">Session的简单应用</h2>
<h3 id="使用session完成用户简单登录">使用Session完成用户简单登录</h3>
<p>在不关闭浏览器的情况下可以自动登录，而不用再次输入密码</p>
<p>思路：首先写一个静态HTML文件Login.html，用作登录界面，输入帐户密码。有两个Servlet实现类LoginServlet和IndexServlet，LoginServlet用来验证输入帐户密码是否匹配，输出对应提示信息，IndexServlet用来检查Session是否已经有了User，如果有了证明之前登录成功，直接提示登录成功信息，如果没有，重定向到登录界面。并将IndexServlet设置为默认打开文件。</p>
<p>代码（User类和UserDB类省略）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//LoginServlet的doPost方法</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获得传来的参数</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//验证是否为正确的用户名和密码</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> UserDB.find(username, password);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(user == <span class="literal">null</span>) &#123; <span class="comment">//如果不是，输出登录失败提示信息</span></span><br><span class="line">            response.getWriter().print(<span class="string">&quot;&lt;h3&gt;用户名或密码错误，无法登陆!&lt;/h3&gt;&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//添加该user对象到Session中</span></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line">        session.setAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">		<span class="comment">//打印登录成功提示信息</span></span><br><span class="line">        response.getWriter().print(<span class="string">&quot;成功登录!&quot;</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//IndexServlet的doGet方法</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//首先获得User对象，如果为空，证明没有登录成功过，转到登录界面，否则打印登录成功提示信息</span></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) session.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(user == <span class="literal">null</span>) &#123;</span><br><span class="line">            response.sendRedirect(<span class="string">&quot;Login.html&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            response.getWriter().print(<span class="string">&quot;用户登录成功！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="session和-cookie的区别">Session和 Cookie的区别</h2>
<ol type="1">
<li><p>从存储方式上比较</p>
<ul>
<li>Cookie只能存储字符串，如果要存储非ASCII字符串还要进行编码</li>
<li>Session可以存储任意类型的数据，相当于一个容器</li>
</ul></li>
<li><p>从隐私安全比较</p>
<ul>
<li>Cookie存储在浏览器，对客户端可见，信息容易泄漏出去，如果使用，最好进行加密</li>
<li>Session存储在服务器上，对客户端透明，不存在隐私泄漏问题</li>
</ul></li>
<li><p>从有效期上比较</p>
<ul>
<li>Cookie可以保存在硬盘上，只需要设置maxAge为比较大的正整数</li>
<li>Session保存在服务器中，设置maxInactiveInterval属性值来确定Session有效期，并且Session依赖于JSESSIONID的Cookie，该Cookie默认maxAge属性为-1，如果关闭了浏览器，该Session虽然没有从服务器中消亡，但也无法再使用，失效了</li>
</ul></li>
<li><p>从对服务器的负担比较</p>
<ul>
<li>Session是保存在服务器的，每个用户都会产生一个Session，如果并发访问量很大，是不能使用Session的，Session会占用大量内存</li>
<li>Cookie是保存在客户端的，不占用服务器资源，像一些大型网站，一般都会使用Cookie来进行会话跟踪</li>
</ul></li>
<li><p>从浏览器支持上比较</p>
<ul>
<li>如果浏览器禁用Cookie，Cookie就无法使用了</li>
<li>禁用Cookie，Session还可以通过URL地址重写来进行会话跟踪</li>
</ul></li>
<li><p>从跨域名上比较</p>
<ul>
<li>Cookie可以设置domain属性来实现跨域名</li>
<li>Session只在当前域名内有效，不可跨域名</li>
</ul></li>
</ol>
<p>如果仅仅使用Cookie或者Session达不到理想效果，那么可以两者结合来使用。</p>
<p>例如，做一个购物系统，使用Session来记录购买过的商品，当关闭浏览器时，购买记录就全部消失，这时候可以使用Cookie来保存购买记录。</p>
<p>总之，两者要灵活使用，以达到我们希望的效果。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/JavaWeb/Servlet/9-Cookie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/JavaWeb/Servlet/9-Cookie/" class="post-title-link" itemprop="url">8-Cookie</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 13:42:39 / 修改时间：16:55:37" itemprop="dateCreated datePublished" datetime="2022-05-11T13:42:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/javaweb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="背景知识">背景知识</h2>
<p>会话技术：访问一个网站，只要不关闭该浏览器，不管用户点击多少超链接，访问多少资源，直到用户关闭浏览器，整个过程称为一次会话。</p>
<p>会话跟踪技术可以解决很多问题</p>
<ul>
<li>在登录时，很多会问是否要自动登录，等下次登陆就不需要输入账户密码</li>
<li>根据我之前浏览的商品，猜我喜欢什么商品</li>
</ul>
<p>会话跟踪技术有Cookie和Session。先说Cookie。</p>
<h2 id="介绍">介绍</h2>
<ul>
<li>Cookie来自于Servlet规范中一个工具类</li>
<li>如果两个Servlet来自同一个网站，并且为同一个浏览器/用户服务，那么可以使用Cookie对象进行数据共享</li>
<li>cookie存放当前用户的私人数据，在共享数据过程中提高服务质量</li>
</ul>
<p>网页之间的交互通过HTTP协议来传输数据，但是HTTP协议是无状态的协议，意思是一旦数据提交完，浏览器和服务器连接关闭，再次交互的时候重新建立新的连接，所以服务器无法确认用户信息，所有W3C组织提出：给每个用户发一个通行证，无论谁访问的时候都需要携带通行证，服务器通过这个通行证来确认用户的信息，这个通行证就是Cookie。</p>
<p>Cookie的工作流程：<strong>浏览器访问数据库，如果服务器需要记录该用户的状态，就使用响应对象response向浏览器发送Cookie，可以一次添加多个Cookie，浏览器把Cookie保存起来，当浏览器再次访问服务器时，浏览器会把请求的网址连通Cookie一起交给服务器。</strong></p>
<p>响应对象将Cookie放在响应头中，浏览器请求时将Cookie放在请求头中。</p>
<h2 id="常用方法">常用方法</h2>
<p>Cookie类用于创建一个Cookie对象，一个Cookie只能放一个键值对，且类型只能为String，<strong>并且键值对中的value不能为中文。</strong></p>
<ul>
<li>在response接口中定义了一个<code>addCookie(Cookie
cookie)</code>方法，它用于在其响应头中增加一个响应的Set-Cookie头字段</li>
<li>request接口定义了<code>getCookie()</code>方法，用于获取客户端提交的Cookie</li>
</ul>
<p>常用的Cookie方法：</p>
<ul>
<li>public Cookie(String name, String
value)：Cookie的构造方法，name定义变量名，value定义变量值</li>
<li>setValue()和getValue方法</li>
<li>setMaxAge和getMaxAge方法</li>
<li>setPath和getPath方法</li>
<li>setDomain和getDomain方法</li>
<li>getName方法</li>
</ul>
<h2 id="使用cookie">使用Cookie</h2>
<p>首先创建Cookie对象，然后使用响应对象添加Cookie，代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"><span class="comment">//创建Cookie，指定名字和值</span></span><br><span class="line"><span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;host&quot;</span>, “localhost<span class="string">&quot;)；</span></span><br><span class="line"><span class="string">response.addCookie(cookie);</span></span><br><span class="line"><span class="string">cookie.setMaxAge(1000);</span></span><br></pre></td></tr></table></figure>
<h2 id="cookie的特性">Cookie的特性</h2>
<h3 id="cookie的不可跨域名性">Cookie的不可跨域名性</h3>
<p>Cookie具有不可跨域名性，也就是说，浏览器判断一个网站能操作另一个网址的Cookie的一句是域名，例如在访问百度时，浏览器只会把百度给的Cookie发过去，但是不会带上Google的Cookie。</p>
<h3 id="cookie保存中文">Cookie保存中文</h3>
<p>中文字符属于Unicode字符集，Cookie使用Unicode字符时需要对Unicode字符进行编码，同样，在取出Cookie时同样需要使用UTF-8进行解码。可以使用<code>URLDecoder.encode(String
value, "UTF-8")</code>和<code>URLDecoder.decode(String value,
"UTF-8")</code>进行编码和解码。</p>
<h3 id="cookie的有效期">Cookie的有效期</h3>
<p>Cookie的有效期是通过setMaxAge()来设置的。</p>
<ul>
<li><p>如果MaxAge为正数，浏览器会把Cookie写到硬盘中，只要还在MaxAge秒之前，登陆浏览器时该Cookie就有效（不论关了浏览器还是电脑）</p></li>
<li><p>如果MaxAge为负数，Cookie就是临时性的，仅仅在本浏览器内有效，关闭了浏览器Cookie就会失效，Cookie也不会写入到硬盘</p></li>
<li><p>如果MaxAge为0，则表示删除该Cookie，Cookie机制没有提供删除Cookie对应方法，所以把MaxAge设置为0等同于删除Cookie</p></li>
</ul>
<p><strong>MaxAge默认值为-1。</strong></p>
<h3 id="cookie的修改和删除">Cookie的修改和删除</h3>
<p>Cookie机制没有提供修改Cookie的方法，那么要如何修改Cookie的值呢？</p>
<p>先来说说Cookie的存储方式，Cookie存储类似Map集合，name=value，是一个键值对，</p>
<p>Cookie的名称相同，通过response添加到浏览器，会覆盖掉原来的Cookie。</p>
<p>所以修改Cookie时，只需要创建一个和要修改的Cookie名称相同的Cookie，value为想修改的值即可。</p>
<p>删除Cookie，就可以把名称相同的Cookie的MaxAge设为0，添加到浏览器，就可以实现修改。</p>
<p><strong>注意：新建的Cookie除了value、maxAge之外的其他所有属性都要和原来的Cookie相同，否则浏览器会视为不同的Cookie，不会覆盖，导致修改删除失败。</strong></p>
<h3 id="cookie的域名">Cookie的域名</h3>
<p>Cookie的domain属性决定了运行访问的域名，domain的值格式规定为".域名"</p>
<ul>
<li>Cookie的隐私安全机制决定Cookie是不可跨域名的，也就是说www.baidu.com和www.google.com之间的Cookie互不影响，没有关系。并且即使同一级域名，不同二级域名也不能交接，也就是说：www.google.com和www.image.google.com的Cookie也不能互相访问</li>
</ul>
<p>如果希望一级域名相同的网页Cookie时间可以相互访问，就需要使用domain方法</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;zhaodaxin&quot;</span>);</span><br><span class="line">cookie.setMaxAge(<span class="number">1000</span>);</span><br><span class="line">cookie.setDomain(<span class="string">&quot;.google.com&quot;</span>);</span><br><span class="line">response.addCookie(cookie);</span><br></pre></td></tr></table></figure>
<p>即 使用<code>cookie.setDomain()</code>来进行设置。</p>
<h3 id="cookie的路径">Cookie的路径</h3>
<p>Cookie的path属性决定允许访问Cookie的路径，如果值为"/"即代表所有网页的资源都可以访问Cookie，现在如果只想Servlet1可以获取到Cookie，其他资源都不可以获取，那么代码应该为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;java&quot;</span>);</span><br><span class="line">Cookie.setPath(<span class="string">&quot;/Servlet1&quot;</span>);</span><br><span class="line">cookie.setMaxAge(<span class="number">1000</span>);</span><br><span class="line">response.addCookie(cookie);</span><br></pre></td></tr></table></figure>
<p>使用<code>cookie.setPath()</code>来进行设置。</p>
<h2 id="cookie的安全属性">Cookie的安全属性</h2>
<p>HTTP协议不仅仅是无状态的，也是不安全的。如果不希望Cookie在非安全协议中传输，可以设置Cookie的secure属性为true，那么浏览器只会在HTTPS和SSL等安全协议中进行传输。</p>
<p>设置secure属性为true不会将Cookie的内容加密，如果想保证安全，最好是用md5算法加密。</p>
<h2 id="section"></h2>
<h3 id="显示上次用户访问时间">显示上次用户访问时间</h3>
<ul>
<li><p>核心逻辑就是在每次登陆的时候，取到Cookie保存的上次访问时间，然后先输出上次访问时间，再更新这个值</p></li>
<li><p>访问Servlet只有两种情况:</p>
<pre><code>                                  1. 第一次访问

 2. 已经访问过了</code></pre></li>
</ul>
<p>​</p>
<pre><code>所以需要判断一下是第一次访问，还是已经访问过了

代码如下：

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OneServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    </span><br><span class="line">            <span class="comment">//创建日期格式字符串</span></span><br><span class="line">            <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd-HH:mm:ss&quot;</span>);</span><br><span class="line">            response.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">            response.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> response.getWriter();</span><br><span class="line">    </span><br><span class="line">            <span class="comment">//获得Cookie数组</span></span><br><span class="line">            Cookie[] cookies = request.getCookies();</span><br><span class="line">    </span><br><span class="line">            <span class="comment">//初始日期值为null</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">cookieValue</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; cookies != <span class="literal">null</span> &amp;&amp; i &lt; cookies.length; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(cookies[i].getName().equals(<span class="string">&quot;time&quot;</span>)) &#123;</span><br><span class="line">                    cookieValue = cookies[i].getValue();</span><br><span class="line">                    out.print(<span class="string">&quot;上次访问的时间为：&quot;</span> + cookieValue);</span><br><span class="line">                    cookies[i].setValue(sdf.format(<span class="keyword">new</span> <span class="title class_">Date</span>()));</span><br><span class="line">                    response.addCookie(cookies[i]);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            <span class="comment">//如果没有日期值，那么cookieValue为null</span></span><br><span class="line">            <span class="keyword">if</span>(cookieValue == <span class="literal">null</span>) &#123;</span><br><span class="line">                out.print(<span class="string">&quot;这是第一次访问&quot;</span>);</span><br><span class="line">                <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;time&quot;</span>, sdf.format(<span class="keyword">new</span> <span class="title class_">Date</span>()));</span><br><span class="line">                cookie.setMaxAge(<span class="number">20000</span>);</span><br><span class="line">                response.addCookie(cookie);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">​    </span><br><span class="line">​        &#125;</span><br><span class="line">​    &#125;</span><br><span class="line">​    ```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">​    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 显示用户上次访问的商品</span><br><span class="line"></span><br><span class="line">以书籍为例子，先定义一个Book类和一个Books类：</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line"><span class="comment">//Book类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Book</span><span class="params">(String id, String name, String author)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.author = author;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    /set和get方法...</span><br><span class="line">&#125;    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Books类</span></span><br><span class="line"><span class="keyword">import</span> java.util.LinkedHashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Books</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用LinkedHashMap存放书籍和对应的序号id</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LinkedHashMap&lt;String, Book&gt; books = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        books.put(<span class="string">&quot;1&quot;</span>, <span class="keyword">new</span> <span class="title class_">Book</span>(<span class="string">&quot;1&quot;</span>, <span class="string">&quot;javaweb&quot;</span>, <span class="string">&quot;zhong&quot;</span>));</span><br><span class="line">        books.put(<span class="string">&quot;2&quot;</span>, <span class="keyword">new</span> <span class="title class_">Book</span>(<span class="string">&quot;2&quot;</span>, <span class="string">&quot;java&quot;</span>, <span class="string">&quot;fu&quot;</span>));</span><br><span class="line">        books.put(<span class="string">&quot;3&quot;</span>, <span class="keyword">new</span> <span class="title class_">Book</span>(<span class="string">&quot;3&quot;</span>, <span class="string">&quot;oracle&quot;</span>, <span class="string">&quot;cheng&quot;</span>));</span><br><span class="line">        books.put(<span class="string">&quot;4&quot;</span>, <span class="keyword">new</span> <span class="title class_">Book</span>(<span class="string">&quot;4&quot;</span>, <span class="string">&quot;mysql&quot;</span>, <span class="string">&quot;ou&quot;</span>));</span><br><span class="line">        books.put(<span class="string">&quot;5&quot;</span>, <span class="keyword">new</span> <span class="title class_">Book</span>(<span class="string">&quot;5&quot;</span>, <span class="string">&quot;ajax&quot;</span>, <span class="string">&quot;zi&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取所有书籍信息</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LinkedHashMap&lt;String, Book&gt; <span class="title function_">getBooks</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> books;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre>
<p>BooksSevlet负责输出所有书籍，并附上超链接，链接到OneServlet，点击显示书籍详细信息，并添加或者修改Cookie，Cookie名称为“bookHistory”,最多存放三本书籍id，id之间使用"_"连接，OneServlet首先显示对应书籍信息，然后添加或者修改对应Cookie，BooksServlet除了负责输出所有书籍，还需要获取浏览器发来的bookHistory对应Cookie，然后将id对应书籍显示出来。</p>
<p>代码为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//BooksServlet</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> entity.Book;</span><br><span class="line"><span class="keyword">import</span> entity.Books;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedHashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BooksServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> response.getWriter();</span><br><span class="line"></span><br><span class="line">        LinkedHashMap&lt;String, Book&gt; books = Books.getBooks();</span><br><span class="line">        Set&lt;Map.Entry&lt;String, Book&gt;&gt; entries = books.entrySet();</span><br><span class="line">        out.print(<span class="string">&quot;&lt;h1&gt;网页上所有的书籍：&lt;/h1&gt;&lt;br&gt;&lt;ol&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(Map.Entry&lt;String, Book&gt; bookEntry : entries) &#123;</span><br><span class="line">            <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> bookEntry.getValue();</span><br><span class="line">            out.print(<span class="string">&quot;&lt;li&gt;&lt;a href=&#x27;/myweb/one?id=&quot;</span>+ book.getId() + <span class="string">&quot;&#x27; target=&#x27;_blank&#x27;&gt;&quot;</span> + book.getName() + <span class="string">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(<span class="string">&quot;&lt;/ul&gt;&lt;hr&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Cookie[] cookies = request.getCookies();</span><br><span class="line">        <span class="type">String</span> <span class="variable">bookHistory</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; cookies != <span class="literal">null</span> &amp;&amp; i &lt; cookies.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(cookies[i].getName().equals(<span class="string">&quot;bookHistory&quot;</span>)) &#123;</span><br><span class="line">                bookHistory = cookies[i].getValue();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        out.print(<span class="string">&quot;&lt;h4&gt;您曾经浏览过的书籍：&lt;/h4&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(bookHistory != <span class="literal">null</span>) &#123;</span><br><span class="line">            out.print(<span class="string">&quot;&lt;ul&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">            String[] strings = bookHistory.split(<span class="string">&quot;_&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; strings.length; i++) &#123;</span><br><span class="line">                out.print(<span class="string">&quot;&lt;li&gt;&quot;</span> + books.get(strings[i]).getName() +<span class="string">&quot;&lt;/li&gt;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            out.print(<span class="string">&quot;&lt;/ul&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//OneServlet</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> entity.Book;</span><br><span class="line"><span class="keyword">import</span> entity.Books;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.logging.SimpleFormatter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OneServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//该方法用于获取添加或修改Cookie对应的bookHistory值</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">makeHistory</span><span class="params">(HttpServletRequest request, String id)</span> &#123;</span><br><span class="line"></span><br><span class="line">        Cookie[] cookies = request.getCookies();</span><br><span class="line">        <span class="type">String</span> <span class="variable">bookHistory</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; cookies != <span class="literal">null</span> &amp;&amp; i &lt; cookies.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(cookies[i].getName().equals(<span class="string">&quot;bookHistory&quot;</span>)) &#123;</span><br><span class="line">                bookHistory = cookies[i].getValue();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//如果不存在该Cookie，那么就直接添加id</span></span><br><span class="line">        <span class="keyword">if</span>(bookHistory == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> id;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            String[] strings = bookHistory.split(<span class="string">&quot;_&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> Arrays.asList(strings);</span><br><span class="line">            LinkedList&lt;String&gt; linkedList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">            linkedList.addAll(list);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//如果已经存在该id，那么删除，并重新放到第一个位置</span></span><br><span class="line">            <span class="keyword">if</span>(linkedList.contains(id)) &#123;</span><br><span class="line">                linkedList.remove(id);</span><br><span class="line">                linkedList.addFirst(id);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">//如果不存在，那么如果已经存在三个id，删除最后一个，并将该id添加到第一个</span></span><br><span class="line">                <span class="keyword">if</span>(linkedList.size() &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">                    linkedList.removeLast();</span><br><span class="line">                    linkedList.addFirst(id);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    linkedList.addFirst(id);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//连接字符串</span></span><br><span class="line">            bookHistory = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; linkedList.size() - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                bookHistory = bookHistory + linkedList.get(i) + <span class="string">&quot;_&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            bookHistory = bookHistory + linkedList.getLast();</span><br><span class="line">            <span class="keyword">return</span> bookHistory;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> response.getWriter();</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">        <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> (Book) Books.getBooks().get(id);</span><br><span class="line">        out.print(<span class="string">&quot;&lt;h3&gt;书的编号为：&quot;</span> + book.getId() + <span class="string">&quot;&lt;/h3&gt;&quot;</span>);</span><br><span class="line">        out.print(<span class="string">&quot;&lt;h3&gt;书的名称为：&quot;</span> + book.getName() + <span class="string">&quot;&lt;/h3&gt;&quot;</span>);</span><br><span class="line">        out.print(<span class="string">&quot;&lt;h3&gt;书的作者为：&quot;</span> + book.getAuthor() + <span class="string">&quot;&lt;/h3&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">bookHistory</span> <span class="operator">=</span> <span class="built_in">this</span>.makeHistory(request, id);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//如果Cookie名称相同，会覆盖先前的Cookie，所以可以直接添加新的</span></span><br><span class="line">        <span class="type">Cookie</span> <span class="variable">cookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;bookHistory&quot;</span>, bookHistory);</span><br><span class="line">        cookie.setMaxAge(<span class="number">20000</span>);</span><br><span class="line">        response.addCookie(cookie);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/JavaWeb/Servlet/8-ServletContext%E6%8E%A5%E5%8F%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/JavaWeb/Servlet/8-ServletContext%E6%8E%A5%E5%8F%A3/" class="post-title-link" itemprop="url">7-ServletContext接口</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 13:41:39 / 修改时间：16:55:35" itemprop="dateCreated datePublished" datetime="2022-05-11T13:41:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/javaweb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>当Tomcat启动时，就会创建一个ServletContext对象，它代表着当前web站点，该网站所有Servlet共享一个ServletContext对象，所有Servlet对象之间可以通过ServletContext实现通讯。</p>
<p>ServletContext对象被称为域对象，或者全局作用域对象，可以把它理解为一个容器，我们把需要共享的数据放到这个容器中，需要对应数据的Servlet对象就从这个容器中拿。</p>
<p>实现Servlet通讯要用ServletContext的<code>setAttribute(String name,
Object
obj)</code>方法，第一个参数为变量名，第二个参数为变量值；然后使用<code>servletContext.getAttribute(String
name)</code>获取指定变量值，需要强制类型转换，例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一个Servlet代码</span></span><br><span class="line"><span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext();</span><br><span class="line"><span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> <span class="string">&quot;HAHAHAH&quot;</span>;</span><br><span class="line">servletContext.setAttribute(<span class="string">&quot;Name&quot;</span>, value);</span><br><span class="line"></span><br><span class="line"><span class="comment">//第二个Servlet代码</span></span><br><span class="line"><span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext();</span><br><span class="line"><span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> servletContext = (String)servletContext.getAttribute(<span class="string">&quot;name&quot;</span>);</span><br></pre></td></tr></table></figure>
<h4 id="获取web站点配置的信息">获取web站点配置的信息</h4>
<p>如果想要让所有Servlet都能够获取连接数据库的信息，不可能在web.xml给每个Servlet都配置，太麻烦，web.xml文件支持对整个站点进行配置参数信息，所有的Servlet都可以拿到该配置信息。</p>
<p>例如： web.xml的内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>HAHAHA<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Servlet的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext();</span><br><span class="line"><span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> servletContext.getInitParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">System.out.println(value);</span><br></pre></td></tr></table></figure>
<p>获取web.xml配置参数时，要使用getInitParameter(String name)方法。</p>
<h4 id="servletcontext的生命周期">ServletContext的生命周期</h4>
<ul>
<li>当Tomcat启动过程中，自动为当前网站在内存中创建一个ServletContext对象</li>
<li>在Http服务器运行期间，一个网站只有一个ServletContext对象，并且一直处于存活状态</li>
<li>当Http服务器准备关闭时，负责将当前网站中ServletContext对象进行销毁</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/JavaWeb/Servlet/7-%E4%BD%BF%E7%94%A8HttpServletRequest%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%85%B1%E4%BA%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/JavaWeb/Servlet/7-%E4%BD%BF%E7%94%A8HttpServletRequest%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%85%B1%E4%BA%AB/" class="post-title-link" itemprop="url">6-HttpServletRequest进行数据共享</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 13:40:39 / 修改时间：16:55:33" itemprop="dateCreated datePublished" datetime="2022-05-11T13:40:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/javaweb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="介绍">介绍</h2>
<p>request对象也是一个域对象，即在一个范围内，可以进行共享。</p>
<p>在一次请求中，利用请求转发进行多个Servlet调用时，使用的是同一个request对象，这时候，就可以利用该对象进行数据共享。</p>
<h2 id="httpservletrequest相关api">HttpServletRequest相关API</h2>
<p>有两个最主要方法进行数据共享</p>
<ul>
<li>void setAttribute(String s, Object
o)：指定名字和任意数据类型的数据存入到request中</li>
<li>Object getAttribute(String s)：获取名为s的数据</li>
</ul>
<p>在request内部维护着一个Map集合，可以存放数据。</p>
<p>这个简单，没有例子！Yeah～</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://zhaoquaner.github.io/2022/05/11/JavaWeb/Servlet/6-%E5%A4%9A%E4%B8%AAServlet%E8%B0%83%E7%94%A8%E8%A7%84%E5%88%99%E5%92%8C%E6%95%B0%E6%8D%AE%E5%85%B1%E4%BA%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://crayon-1302863897.cos.ap-beijing.myqcloud.com/blog_images/avatar.png">
      <meta itemprop="name" content="ZhaoXin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 赵圈儿的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/05/11/JavaWeb/Servlet/6-%E5%A4%9A%E4%B8%AAServlet%E8%B0%83%E7%94%A8%E8%A7%84%E5%88%99%E5%92%8C%E6%95%B0%E6%8D%AE%E5%85%B1%E4%BA%AB/" class="post-title-link" itemprop="url">5-多个Servlet调用规则和数据共享</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-05-11 13:39:39 / 修改时间：16:55:30" itemprop="dateCreated datePublished" datetime="2022-05-11T13:39:39+08:00">2022-05-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/javaweb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>某些来自浏览器的请求，往往需要服务端多个Servlet协同处理，但是浏览器一次只能访问一个Servlet，导致用户需要手动操作浏览器发起多次请求才能得到服务，这样增加了服务的难度，为了提供用户使用感受，所以要求无论本次请求涉及了多少Servlet，用户只需要手动通知浏览器发起一次请求即可。</p>
<h2 id="多个servlet之间的调用规则">多个Servlet之间的调用规则</h2>
<p>有两种解决方案：</p>
<ul>
<li>重定向解决方案</li>
<li>请求转发解决方案</li>
</ul>
<h3 id="重定向解决方案">重定向解决方案</h3>
<p>工作原理：用户手动发送一次请求，第一个Servlet工作完成后，通过重定向方法将第二个Servlet地址写入到响应头location中，然后tomcat将302状态码写入到状态行，然后第二个Servlet继续工作，以此类推。</p>
<p>实现命令：response.sendRedirect("地址")</p>
<p>由于是通过地址栏通知浏览器发起下一次请求，因此请求方式一定是GET</p>
<p>缺点：进行多次往返，大量时间被消耗在往返上，增加用户等待时间：重定向解决方案需要在浏览器和服务器之间</p>
<h3 id="请求转发解决方案">请求转发解决方案</h3>
<p>工作原理：用户第一次通过手动要求浏览器访问OneServlet，然后OneServlet工作完毕后，通过当前的请求对象代替浏览器向Tomcat发送请求，调用TwoServlet，然后Tomcat调用TwoServlet</p>
<p>实现命令：请求对象代替浏览器向Tomcat发送请求，</p>
<ol type="1">
<li><p>通过当前对象生成资源文件申请报告对象，RequestDispatcher report =
request.getRequestDispatcher("/资源文件名")；一定要以"/"开头</p></li>
<li><p>将报告对象发送给Tomcat</p>
<p>report.forward("当前请求对象"，"当前响应对象");</p>
<p>请求的方式由第一次浏览器发送请求的方式相同，即和浏览器的发送请求方式保持一致，因为所有Servlet共享一个请求协议包</p>
<p>优点：无论需要调用多少Servlet，用户只需要手动发送一次请求</p>
<p>​
Servlet之间互相调用发生在服务端计算机，节省了服务端和浏览器之间的请求时间</p>
<p><strong>注意：</strong>Http服务器只能调用当前网站的资源文件</p>
<p>特点：</p>
<ul>
<li>浏览器只发送一次请求</li>
</ul>
<h2 id="总结">总结</h2>
<p>简单来说，重定向方案就是浏览器发送一次请求，然后第一个Servlet执行完毕，通知浏览器去访问第二个Servlet，然后浏览器接着再次发送请求，以此类推；</p>
<p>而请求转发方案就是浏览器发送一次请求，然后第一个Servlet执行完毕，不需要通知浏览器去访问下一个Servlet，而是直接去调用下一个Servlet。</p>
<h2
id="多个servlet之间的数据共享实现方案">多个Servlet之间的数据共享实现方案</h2>
<p>所谓数据共享，就是第一个Servlet执行完后，将产生的数据交给下一个Servlet来处理</p>
<p>Servlet规范一共提供了四种数据共享方案</p>
<ol type="1">
<li>ServletContext接口</li>
<li>Cookie类</li>
<li>HttpSession接口</li>
<li>HttpServletRequest接口</li>
</ol></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/12/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/14/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZhaoXin</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
